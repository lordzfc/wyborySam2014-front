"use strict";angular.module("wyborySam2014",["nvd3","smart-table","ui.router","ui.bootstrap","wyborySam2014.area","wyborySam2014.charts","wyborySam2014.tables","wyborySam2014.utils","wyborySam2014.http","wyborySam2014.landingPage"]).constant("DEV_API_PREFIX","http://localhost:8081/api/").constant("HEROKU_API_PREFIX","wyreczamy-pkw.herokuapp.com/api/"),angular.module("wyborySam2014").config(["$stateProvider",function(t){t.state("stats-app",{url:"/{dataUrl}",controller:"wyborySam2014.area.ctrl",templateUrl:"area/area.ctrl.html"}).state("landing",{url:"",controller:"wyborySam2014.landing.ctrl",templateUrl:"area/area.ctrl.html",deepStateRedirect:{"default":{state:"stats-app"}}})}]),angular.module("wyborySam2014.area",[]),angular.module("wyborySam2014.area").controller("wyborySam2014.area.ctrl",["$scope","$rootScope","$http","$stateParams","httpService","urls",function(t,a,e,r,n,o){var i=function(a){var e=a.filter(function(a){return a.type===t.electionKind.type})[0];return e},l=function(a,e){t.showSpinner=!0,n.getStatsData(a).success(function(r){t.stats=r,t.siteName=e,o.changeDataUrl(a,t.dataUrl,"stats"),t.showSpinner=!1})};t.chartData={key:"",values:[]},t.dataUrl=r.dataUrl,t.showSpinner=!1,n.getAreasTree().success(function(a){t.tree=a;var e=o.decode(r.dataUrl),n=o.getSiteName(e);t.electionKind=o.getElectionKind(a,e),t.navTree=i(a),l(e,n)}),t.$watch("electionKind",function(e,r){e!==r&&void 0!==r&&(t.navTree=i(t.tree),a.$broadcast("area::electionTypeChange"),l(t.electionKind.url,"Warszawa"))});var c=a.$on("area::areaTypeChange",function(t,a,e){l(a,e)});t.$on("$destroy",c),t.menuIsVisible=function(){return t.openMenu===!1||t.openMenu===!0},t.menuIsOff=function(){return t.openMenu===!1},t.dropdownIsOff=function(){return t.electionKindsDropwn===!1},t.dropdownIsVisible=function(){return t.electionKindsDropwn===!1||t.electionKindsDropwn===!0},t.changeElectionKind=function(a){t.dataUrl=a.url,t.electionKind={name:a.name,type:a.type,url:a.url},n.getStatsData(a.url).success(function(a){t.statsData=a}),o.changeDataUrl(a.url,"stats"),t.electionKindsDropwn=!1},t.scrollTo=function(t){return"#charts"===t?void $(t).velocity("scroll",{axis:"y",offset:-140}):void $(t).velocity("scroll",{axis:"y",offset:-60})}}]),angular.module("wyborySam2014.charts",[]),angular.module("wyborySam2014.http",[]),angular.module("wyborySam2014.http").factory("httpService",["$http","DEV_API_PREFIX",function(t,a){var e={};return e.getAreasTree=function(){return t.get(a+"stats/areas-tree/")},e.getStatsData=function(e){return t.get(a+e)},e}]),angular.module("wyborySam2014.landingPage",[]),angular.module("wyborySam2014.landingPage").controller("wyborySam2014.landing.ctrl",["$scope","$state","httpService","urls",function(t,a,e,r){a.go("stats-app")}]),angular.module("wyborySam2014.tables",[]),angular.module("wyborySam2014.utils",[]),angular.module("wyborySam2014.utils").factory("urls",["$location",function(t){var a={};return a.code=function(t){return t.replace(/\//g,".")},a.decode=function(t){return t.replace(/\./g,"/")},a.getSiteName=function(t,a){if(t)var e=t.split(a||"/"),r=e[e.length-2].split("-");return t&&"circle"===r[0]?"Okręg nr "+r[1]:t&&"circuit"===r[0]?"Obwód nr "+r[1]:t&&"district"===r[0]?r[1]:"Warszawa"},a.getElectionKind=function(t,a,e){if(!a||!t)return{name:"Wybory do Rady Miasta",type:"city_council",url:"stats/city_council/"};var r=a.split(e||"/")[1],n=t.filter(function(t){return t.type===r})[0];return{name:n.name,type:n.type,url:n.url}},a.changeDataUrl=function(e,r,n){var o=t.path().split("/");o.pop(),o.push(a.code(e)),t.path(o.join("/"))},a}]),angular.module("wyborySam2014.area").directive("mainCity",["$rootScope",function(t){return{scope:{election:"="},restrict:"E",templateUrl:"area/tree/main-city.dir.html",link:function(a,e,r,n){a.deactivateAllBranches=function(a,e){a.stopPropagation(),t.$broadcast("tree.city::deactivateAllBranches")},a.changeArea=function(a,e){a.stopPropagation(),t.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.area").directive("areasTree",["$rootScope",function(t){return{scope:{tree:"="},restrict:"E",templateUrl:"area/tree/tree.dir.html",link:function(a,e,r,n){a.active=-1,a.activateDeactivate=function(t,e){return t.stopPropagation(),-1===a.active?void(a.active=e):void(a.active=-1)};var o=t.$on("area::electionTypeChange",function(){a.active=-1});a.$on("$destroy",o);var i=t.$on("tree.city::deactivateAllBranches",function(){a.active=-1});a.$on("$destroy",i),a.changeArea=function(a,e){a.stopPropagation(),t.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.charts").controller("wyborySam2014.charts.mainCtrl",["$scope",function(t){t.options={chart:{type:"discreteBarChart",height:400,margin:{top:20,right:40,bottom:50,left:55},x:function(t){return t.label},y:function(t){return t.value},showValues:!1,valueFormat:function(t){return d3.format(",.2f%")(t)},duration:500,xAxis:{},yAxis:{axisLabelDistance:0}}}}]),angular.module("wyborySam2014.charts").directive("chartsView",[function(){return{scope:{data:"="},controller:"wyborySam2014.charts.mainCtrl",restrict:"E",templateUrl:"charts/main/charts.dir.html",link:function(t,a,e,r){t.chartData=[{key:"Cumulative Return",values:[]}],t.$watch("data",function(a,e){a!==e&&(t.chartData[0].values=_.map(a.votes,function(t){return{value:t.percentage,label:t.political_party}}),t.chartData[0].values.sort(function(t,a){return a.value-t.value}))})}}}]),angular.module("wyborySam2014.tables").controller("wyborySam2014.tables.mainCtrl",["$scope",function(t){t.rowCollection=[{firstName:"Laurent",lastName:"Renard",birthDate:new Date("1987-05-21"),balance:102,email:"whatever@gmail.com"},{firstName:"Blandine",lastName:"Faivre",birthDate:new Date("1987-04-25"),balance:-2323.22,email:"oufblandou@gmail.com"},{firstName:"Francoise",lastName:"Frere",birthDate:new Date("1955-08-27"),balance:42343,email:"raymondef@gmail.com"}]}]),angular.module("wyborySam2014.tables").directive("tablesView",[function(){return{scope:{stats:"=",electionKind:"="},controller:"wyborySam2014.tables.mainCtrl",restrict:"E",templateUrl:"tables/main/tables.dir.html",link:function(t,a,e,r){}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvYXBwLmpzIiwiL3NvdXJjZS9jb25maWcuanMiLCIvc291cmNlL2FyZWEvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2FyZWEvYXJlYS5jdHJsLmpzIiwiL3NvdXJjZS9jaGFydHMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvaHR0cC5mYWN0LmpzIiwiL3NvdXJjZS9sYW5kaW5nX3BhZ2UvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2xhbmRpbmdfcGFnZS9sYW5kaW5nLmN0cmwuanMiLCIvc291cmNlL3RhYmxlcy9fZGVmaW5pdGlvbi5qcyIsIi9zb3VyY2UvdXRpbHMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL3V0aWxzL2RhdGEtdXJscy5mYWN0LmpzIiwiL3NvdXJjZS9hcmVhL3RyZWUvbWFpbi1jaXR5LmRpci5qcyIsIi9zb3VyY2UvYXJlYS90cmVlL3RyZWUuZGlyLmpzIiwiL3NvdXJjZS9jaGFydHMvbWFpbi9jaGFydHMuY3RybC5qcyIsIi9zb3VyY2UvY2hhcnRzL21haW4vY2hhcnRzLmRpci5qcyIsIi9zb3VyY2UvdGFibGVzL21haW4vdGFibGVzLmN0cmwuanMiLCIvc291cmNlL3RhYmxlcy9tYWluL3RhYmxlcy5kaXIuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsImRlZXBTdGF0ZVJlZGlyZWN0IiwiZGVmYXVsdCIsIiRzY29wZSIsIiRyb290U2NvcGUiLCIkaHR0cCIsIiRzdGF0ZVBhcmFtcyIsImh0dHBTZXJ2aWNlIiwidXJscyIsImdldE5hdlRyZWUiLCJ0cmVlIiwib25lVHJlZSIsImZpbHRlciIsIm9iaiIsInR5cGUiLCJlbGVjdGlvbktpbmQiLCJnZXREYXRhIiwibmFtZSIsInNob3dTcGlubmVyIiwiZ2V0U3RhdHNEYXRhIiwic3VjY2VzcyIsInN0YXRzIiwic2l0ZU5hbWUiLCJjaGFuZ2VEYXRhVXJsIiwiZGF0YVVybCIsImNoYXJ0RGF0YSIsImtleSIsInZhbHVlcyIsImdldEFyZWFzVHJlZSIsImRlY29kZSIsImdldFNpdGVOYW1lIiwiZ2V0RWxlY3Rpb25LaW5kIiwibmF2VHJlZSIsIiR3YXRjaCIsInZhbCIsIm9sZFZhbCIsInVuZGVmaW5lZCIsIiRicm9hZGNhc3QiLCJkZXMiLCIkb24iLCJlIiwibWVudUlzVmlzaWJsZSIsIm9wZW5NZW51IiwibWVudUlzT2ZmIiwiZHJvcGRvd25Jc09mZiIsImVsZWN0aW9uS2luZHNEcm9wd24iLCJkcm9wZG93bklzVmlzaWJsZSIsImNoYW5nZUVsZWN0aW9uS2luZCIsImtpbmQiLCJkYXRhIiwic3RhdHNEYXRhIiwic2Nyb2xsVG8iLCIkIiwidmVsb2NpdHkiLCJheGlzIiwib2Zmc2V0IiwiZmFjdG9yeSIsIkRFVl9BUElfUFJFRklYIiwic2VsZiIsImdldCIsIiRzdGF0ZSIsImdvIiwiJGxvY2F0aW9uIiwiY29kZSIsInJlcGxhY2UiLCJzcGxpdFVybFBhcmFtIiwidXJsc0FyciIsInNwbGl0IiwiZGF0YVR5cGUiLCJsZW5ndGgiLCJub2RlIiwiU3RhdGVQYXJhbURhdGFVcmwiLCJzaXRlVHlwZSIsInBhdGgiLCJwb3AiLCJwdXNoIiwiam9pbiIsImRpcmVjdGl2ZSIsInNjb3BlIiwiZWxlY3Rpb24iLCJyZXN0cmljdCIsImxpbmsiLCJpRWxtIiwiaUF0dHJzIiwiZGVhY3RpdmF0ZUFsbEJyYW5jaGVzIiwiZXZlbnQiLCJlbGVtZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwiY2hhbmdlQXJlYSIsImFjdGl2ZSIsImFjdGl2YXRlRGVhY3RpdmF0ZSIsImluZGV4IiwiZGVzMSIsIm9wdGlvbnMiLCJjaGFydCIsImhlaWdodCIsIm1hcmdpbiIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsIngiLCJkIiwibGFiZWwiLCJ5IiwidmFsdWUiLCJzaG93VmFsdWVzIiwidmFsdWVGb3JtYXQiLCJkMyIsImZvcm1hdCIsImR1cmF0aW9uIiwieEF4aXMiLCJ5QXhpcyIsImF4aXNMYWJlbERpc3RhbmNlIiwiXyIsIm1hcCIsInZvdGVzIiwidiIsInBlcmNlbnRhZ2UiLCJwb2xpdGljYWxfcGFydHkiLCJzb3J0IiwiYSIsImIiLCJyb3dDb2xsZWN0aW9uIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJiaXJ0aERhdGUiLCJEYXRlIiwiYmFsYW5jZSIsImVtYWlsIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUNBQSxTQUFBQyxPQUFBLGlCQUNBLE9BQ0EsY0FDQSxZQUNBLGVBQ0EscUJBQ0EsdUJBQ0EsdUJBQ0Esc0JBQ0EscUJBQ0EsOEJBRUFDLFNBQUEsaUJBQUEsOEJBQ0FBLFNBQUEsb0JBQUEsb0NDZEFGLFFBQUFDLE9BQUEsaUJBQ0FFLFFBQUEsaUJBQUEsU0FBQUMsR0FDQUEsRUFDQUMsTUFBQSxhQUNBQyxJQUFBLGFBQ0FDLFdBQUEsMEJBQ0FDLFlBQUEsd0JBRUFILE1BQUEsV0FDQUMsSUFBQSxHQUNBQyxXQUFBLDZCQUNBQyxZQUFBLHNCQUNBQyxtQkFBQUMsV0FBQUwsTUFBQSxtQkNYQUwsUUFBQUMsT0FBQSx5QkNEQUQsUUFBQUMsT0FBQSxzQkFDQU0sV0FBQSwyQkFBQSxTQUFBLGFBQUEsUUFBQSxlQUFBLGNBQUEsT0FDQSxTQUFBSSxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBRSxPQUFBLFNBQUFDLEdBQ0EsTUFBQUEsR0FBQUMsT0FBQVgsRUFBQVksYUFBQUQsT0FDQSxFQUNBLE9BQUFILElBR0FLLEVBQUEsU0FBQWxCLEVBQUFtQixHQUNBZCxFQUFBZSxhQUFBLEVBQ0FYLEVBQUFZLGFBQUFyQixHQUFBc0IsUUFBQSxTQUFBQyxHQUNBbEIsRUFBQWtCLE1BQUFBLEVBQ0FsQixFQUFBbUIsU0FBQUwsRUFDQVQsRUFBQWUsY0FBQXpCLEVB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LFlBQUFDLElBQUEsb0JBQUFDLFlBQ0FtRCxFQUFBN0MsT0FBQSxPQUFBLFNBQUFDLEVBQUFDLEdBQ0FELElBQUFDLElBQ0EyQyxFQUFBckQsVUFBQSxHQUFBRSxPQUFBdUYsRUFBQUMsSUFBQWpGLEVBQUFrRixNQUFBLFNBQUFDLEdBQ0EsT0FDQVosTUFBQVksRUFBQUMsV0FDQWYsTUFBQWMsRUFBQUUsbUJBRUF6QyxFQUFBckQsVUFBQSxHQUFBRSxPQUFBNkYsS0FBQSxTQUFBQyxFQUFBQyxHQUNBLE1BQUFBLEdBQUFqQixNQUFBZ0IsRUFBQWhCLGdCQ3BCQWpILFFBQUFDLE9BQUEsd0JBQ0FNLFdBQUEsaUNBQUEsU0FBQSxTQUFBSSxHQUNBQSxFQUFBd0gsZ0JBQ0FDLFVBQUEsVUFBQUMsU0FBQSxTQUFBQyxVQUFBLEdBQUFDLE1BQUEsY0FBQUMsUUFBQSxJQUFBQyxNQUFBLHVCQUNBTCxVQUFBLFdBQUFDLFNBQUEsU0FBQUMsVUFBQSxHQUFBQyxNQUFBLGNBQUFDLFFBQUEsU0FBQUMsTUFBQSx5QkFDQUwsVUFBQSxZQUFBQyxTQUFBLFFBQUFDLFVBQUEsR0FBQUMsTUFBQSxjQUFBQyxRQUFBLE1BQUFDLE1BQUEsMkJDTEF6SSxRQUFBQyxPQUFBLHdCQUNBb0YsVUFBQSxjQUFBLFdBQ0EsT0FDQUMsT0FDQXpELE1BQUEsSUFDQU4sYUFBQSxLQUVBaEIsV0FBQSxnQ0FDQWlGLFNBQUEsSUFDQWhGLFlBQUEsOEJBQ0FpRixLQUFBLFNBQUFILEVBQUFJLEVBQUFDLEVBQUFwRiIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQnLCBbXG4gICdudmQzJyxcbiAgJ3NtYXJ0LXRhYmxlJyxcbiAgJ3VpLnJvdXRlcicsXG4gICd1aS5ib290c3RyYXAnLFxuICAnd3lib3J5U2FtMjAxNC5hcmVhJyxcbiAgJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJyxcbiAgJ3d5Ym9yeVNhbTIwMTQudGFibGVzJyxcbiAgJ3d5Ym9yeVNhbTIwMTQudXRpbHMnLFxuICAnd3lib3J5U2FtMjAxNC5odHRwJyxcbiAgJ3d5Ym9yeVNhbTIwMTQubGFuZGluZ1BhZ2UnXG4gIF0pXG4uY29uc3RhbnQoJ0RFVl9BUElfUFJFRklYJywgJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MS9hcGkvJylcbi5jb25zdGFudCgnSEVST0tVX0FQSV9QUkVGSVgnLCAnd3lyZWN6YW15LXBrdy5oZXJva3VhcHAuY29tL2FwaS8nKTsiLCJhbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNCcpXG4uY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAkc3RhdGVQcm92aWRlclxuICAuc3RhdGUoJ3N0YXRzLWFwcCcsIHtcbiAgICB1cmw6ICcve2RhdGFVcmx9JyxcbiAgICBjb250cm9sbGVyOiAnd3lib3J5U2FtMjAxNC5hcmVhLmN0cmwnLFxuICAgIHRlbXBsYXRlVXJsOiAnYXJlYS9hcmVhLmN0cmwuaHRtbCdcbiAgfSlcbiAgLnN0YXRlKCdsYW5kaW5nJywge1xuICAgIHVybDogJycsXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQubGFuZGluZy5jdHJsJyxcbiAgICB0ZW1wbGF0ZVVybDogJ2FyZWEvYXJlYS5jdHJsLmh0bWwnLFxuICAgIGRlZXBTdGF0ZVJlZGlyZWN0OiB7IGRlZmF1bHQ6IHsgc3RhdGU6ICdzdGF0cy1hcHAnIH0gfVxuICB9KVxufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuYXJlYScsIFtdKSIsImFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmFyZWEnKVxuLmNvbnRyb2xsZXIoJ3d5Ym9yeVNhbTIwMTQuYXJlYS5jdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckaHR0cCcsICckc3RhdGVQYXJhbXMnLCAnaHR0cFNlcnZpY2UnLCAndXJscycsXG4gIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgaHR0cFNlcnZpY2UsIHVybHMpe1xuICB2YXIgZ2V0TmF2VHJlZSA9IGZ1bmN0aW9uKHRyZWUpIHtcbiAgICB2YXIgb25lVHJlZSA9IHRyZWUuZmlsdGVyKGZ1bmN0aW9uKG9iail7XG4gICAgICByZXR1cm4gb2JqLnR5cGUgPT09ICRzY29wZS5lbGVjdGlvbktpbmQudHlwZTtcbiAgICB9KVswXTtcbiAgICByZXR1cm4gb25lVHJlZTtcbiAgfTtcblxuICB2YXIgZ2V0RGF0YSA9IGZ1bmN0aW9uICh1cmwsIG5hbWUpIHtcbiAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgIGh0dHBTZXJ2aWNlLmdldFN0YXRzRGF0YSh1cmwpLnN1Y2Nlc3MoZnVuY3Rpb24oc3RhdHMpe1xuICAgICAgJHNjb3BlLnN0YXRzID0gc3RhdHM7XG4gICAgICAkc2NvcGUuc2l0ZU5hbWUgPSBuYW1lO1xuICAgICAgdXJscy5jaGFuZ2VEYXRhVXJsKHVybCwgJHNjb3BlLmRhdGFVcmwsICdzdGF0cycpO1xuICAgICAgJHNjb3BlLnNob3dTcGlubmVyID0gZmFsc2U7XG4gICAgfSlcbiAgfTtcblxuICAkc2NvcGUuY2hhcnREYXRhID0ge2tleTogJycsIHZhbHVlczogW119O1xuICAkc2NvcGUuZGF0YVVybCA9ICRzdGF0ZVBhcmFtcy5kYXRhVXJsO1xuICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcblxuICBodHRwU2VydmljZS5nZXRBcmVhc1RyZWUoKS5zdWNjZXNzKGZ1bmN0aW9uKHRyZWUpIHtcbiAgICAkc2NvcGUudHJlZSA9IHRyZWU7XG4gICAgXG4gICAgdmFyIHVybCA9IHVybHMuZGVjb2RlKCRzdGF0ZVBhcmFtcy5kYXRhVXJsKTtcbiAgICB2YXIgbmFtZSA9IHVybHMuZ2V0U2l0ZU5hbWUodXJsKTtcbiAgICAvLyBjb25zb2xlLmxvZygpO1xuICAgICRzY29wZS5lbGVjdGlvbktpbmQgPSB1cmxzLmdldEVsZWN0aW9uS2luZCh0cmVlLCB1cmwpO1xuICAgICRzY29wZS5uYXZUcmVlID0gZ2V0TmF2VHJlZSh0cmVlKTtcbiAgICBnZXREYXRhKHVybCwgbmFtZSk7XG4gIH0pO1xuXG4gICRzY29wZS4kd2F0Y2goJ2VsZWN0aW9uS2luZCcsIGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7XG4gICAgaWYodmFsICE9PSBvbGRWYWwgJiYgb2xkVmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICRzY29wZS5uYXZUcmVlID0gZ2V0TmF2VHJlZSgkc2NvcGUudHJlZSk7XG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2FyZWE6OmVsZWN0aW9uVHlwZUNoYW5nZScpO1xuICAgICAgZ2V0RGF0YSgkc2NvcGUuZWxlY3Rpb25LaW5kLnVybCwgJ1dhcnN6YXdhJyk7XG4gICAgfVxuICB9KTtcblxuICB2YXIgZGVzID0gJHJvb3RTY29wZS4kb24oJ2FyZWE6OmFyZWFUeXBlQ2hhbmdlJywgZnVuY3Rpb24oZSwgdXJsLCBuYW1lKXtcbiAgICBnZXREYXRhKHVybCwgbmFtZSlcbiAgfSk7XG4gICRzY29wZS4kb24oJyRkZXN0cm95JywgZGVzKTtcblxuICAkc2NvcGUubWVudUlzVmlzaWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkc2NvcGUub3Blbk1lbnUgPT09IGZhbHNlIHx8ICRzY29wZS5vcGVuTWVudSA9PT0gdHJ1ZTtcbiAgfTtcbiAgJHNjb3BlLm1lbnVJc09mZiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkc2NvcGUub3Blbk1lbnUgPT09IGZhbHNlO1xuICB9O1xuICBcbiAgJHNjb3BlLmRyb3Bkb3duSXNPZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLmVsZWN0aW9uS2luZHNEcm9wd24gPT09IGZhbHNlO1xuICB9O1xuXG4gICRzY29wZS5kcm9wZG93bklzVmlzaWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkc2NvcGUuZWxlY3Rpb25LaW5kc0Ryb3B3biA9PT0gZmFsc2UgfHwgJHNjb3BlLmVsZWN0aW9uS2luZHNEcm9wd24gPT09IHRydWU7XG4gIH07XG5cbiAgJHNjb3BlLmNoYW5nZUVsZWN0aW9uS2luZCA9IGZ1bmN0aW9uKGtpbmQpIHtcbiAgICAkc2NvcGUuZGF0YVVybCA9IGtpbmQudXJsO1xuICAgICRzY29wZS5lbGVjdGlvbktpbmQgPSB7XG4gICAgICBuYW1lOiBraW5kLm5hbWUsXG4gICAgICB0eXBlOiBraW5kLnR5cGUsXG4gICAgICB1cmw6IGtpbmQudXJsXG4gICAgfTtcbiAgICBodHRwU2VydmljZS5nZXRTdGF0c0RhdGEoa2luZC51cmwpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSl7XG4gICAgICAkc2NvcGUuc3RhdHNEYXRhID0gZGF0YTtcbiAgICB9KVxuICAgIHVybHMuY2hhbmdlRGF0YVVybChraW5kLnVybCwgJ3N0YXRzJyk7XG4gICAgJHNjb3BlLmVsZWN0aW9uS2luZHNEcm9wd24gPSBmYWxzZTtcbiAgfTtcbiAgXG4gICRzY29wZS5zY3JvbGxUbyA9IGZ1bmN0aW9uKGtpbmQpIHtcbiAgICBpZihraW5kID09PSAnI2NoYXJ0cycpIHtcbiAgICAgICQoa2luZCkudmVsb2NpdHkoXCJzY3JvbGxcIiwgeyBheGlzOiBcInlcIiwgb2Zmc2V0OiAtMTQwfSlcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgJChraW5kKS52ZWxvY2l0eShcInNjcm9sbFwiLCB7IGF4aXM6IFwieVwiLCBvZmZzZXQ6IC02MH0pXG5cblxuICB9XG5cbiAgXG4gIFxufV0pOyIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmNoYXJ0cycsIFtdKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0Lmh0dHAnLCBbXSkiLCJhbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5odHRwJylcbi5mYWN0b3J5KCdodHRwU2VydmljZScsIFsnJGh0dHAnLCAnREVWX0FQSV9QUkVGSVgnLCBmdW5jdGlvbigkaHR0cCwgREVWX0FQSV9QUkVGSVgpIHtcbiAgdmFyIHNlbGYgPSB7fTtcbiAgXG4gIHNlbGYuZ2V0QXJlYXNUcmVlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICRodHRwLmdldChERVZfQVBJX1BSRUZJWCArICdzdGF0cy9hcmVhcy10cmVlLycpO1xuICB9O1xuXG4gIHNlbGYuZ2V0U3RhdHNEYXRhID0gZnVuY3Rpb24odXJsKSB7XG4gICAgcmV0dXJuICRodHRwLmdldChERVZfQVBJX1BSRUZJWCArIHVybCk7XG4gIH07XG5cbiAgcmV0dXJuIHNlbGY7XG59XSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5sYW5kaW5nUGFnZScsIFtdKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmxhbmRpbmdQYWdlJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmxhbmRpbmcuY3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZScsJ2h0dHBTZXJ2aWNlJywgJ3VybHMnLFxuZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIGh0dHBTZXJ2aWNlLCB1cmxzKXtcbiAgJHN0YXRlLmdvKCdzdGF0cy1hcHAnKTtcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnRhYmxlcycsIFtdKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnV0aWxzJywgW10pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQudXRpbHMnKVxuLmZhY3RvcnkoJ3VybHMnLCBbJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRsb2NhdGlvbil7XG4gIHZhciBzZWxmID0ge307XG4gIFxuICBzZWxmLmNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLy9nLCAnLicpO1xuICB9O1xuICBcbiAgc2VsZi5kZWNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLi9nLCAnLycpO1xuICB9O1xuXG4gIHNlbGYuZ2V0U2l0ZU5hbWUgPSBmdW5jdGlvbih1cmwsIHNwbGl0VXJsUGFyYW0pIHtcbiAgICBpZih1cmwpIHtcbiAgICAgIHZhciB1cmxzQXJyID0gdXJsLnNwbGl0KHNwbGl0VXJsUGFyYW0gfHwgJy8nKTtcbiAgICAgIHZhciBkYXRhVHlwZSA9IHVybHNBcnJbdXJsc0Fyci5sZW5ndGggLSAyXS5zcGxpdCgnLScpOyAgXG4gICAgfVxuXG4gICAgaWYodXJsICYmIGRhdGFUeXBlWzBdID09PSAnY2lyY2xlJykge1xuICAgICAgcmV0dXJuICdPa3LEmWcgbnIgJyArIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2NpcmN1aXQnKSB7XG4gICAgICByZXR1cm4gJ09id8OzZCBuciAnICsgIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2Rpc3RyaWN0Jykge1xuICAgICAgcmV0dXJuIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiAnV2Fyc3phd2EnO1xuICAgIH1cbiAgfTtcblxuICBzZWxmLmdldEVsZWN0aW9uS2luZCA9IGZ1bmN0aW9uKHRyZWUsIHVybCwgc3BsaXRVcmxQYXJhbSkge1xuICAgIGlmKCF1cmwgfHwgIXRyZWUpIHtcbiAgICAgIHJldHVybiB7IC8vZGVmYXVsdCBkYXRhXG4gICAgICAgIG5hbWU6ICdXeWJvcnkgZG8gUmFkeSBNaWFzdGEnLFxuICAgICAgICB0eXBlOiAnY2l0eV9jb3VuY2lsJyxcbiAgICAgICAgdXJsOiAnc3RhdHMvY2l0eV9jb3VuY2lsLydcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdHlwZSA9IHVybC5zcGxpdChzcGxpdFVybFBhcmFtIHx8ICcvJylbMV07XG4gICAgdmFyIG5vZGUgPSB0cmVlLmZpbHRlcihmdW5jdGlvbihvYmope1xuICAgICAgcmV0dXJuIG9iai50eXBlID09PSB0eXBlO1xuICAgIH0pWzBdO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBub2RlLm5hbWUsXG4gICAgICB0eXBlOiBub2RlLnR5cGUsXG4gICAgICB1cmw6IG5vZGUudXJsXG4gICAgfTtcbiAgfVxuXG4gIHNlbGYuY2hhbmdlRGF0YVVybCA9IGZ1bmN0aW9uKHVybCwgU3RhdGVQYXJhbURhdGFVcmwsIHNpdGVUeXBlKSB7XG4gICAgXG4gICAgdmFyIGRhdGFVcmwgPSAkbG9jYXRpb24ucGF0aCgpLnNwbGl0KCcvJyk7XG4gICAgXG4gICAgLy9pdCBpcyBkYW5nZXJvdXMgYnV0IG5vdyB3b3JrcyBcbiAgICBkYXRhVXJsLnBvcCgpO1xuICAgIFxuICAgIGRhdGFVcmwucHVzaChzZWxmLmNvZGUodXJsKSk7XG4gICAgJGxvY2F0aW9uLnBhdGgoZGF0YVVybC5qb2luKCcvJykpO1xuICB9XG5cbiAgcmV0dXJuIHNlbGY7XG59XSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5hcmVhJylcbi5kaXJlY3RpdmUoJ21haW5DaXR5JywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSl7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIGVsZWN0aW9uOlwiPVwiXG4gICAgfSwgLy8ge30gPSBpc29sYXRlLCB0cnVlID0gY2hpbGQsIGZhbHNlL3VuZGVmaW5lZCA9IG5vIGNoYW5nZVxuICAgIHJlc3RyaWN0OiAnRScsIC8vIEUgPSBFbGVtZW50LCBBID0gQXR0cmlidXRlLCBDID0gQ2xhc3MsIE0gPSBDb21tZW50XG4gICAgdGVtcGxhdGVVcmw6ICdhcmVhL3RyZWUvbWFpbi1jaXR5LmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5kZWFjdGl2YXRlQWxsQnJhbmNoZXMgPSBmdW5jdGlvbihldmVudCwgZWxlbWVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd0cmVlLmNpdHk6OmRlYWN0aXZhdGVBbGxCcmFuY2hlcycpIFxuICAgICAgfVxuXG4gICAgICBzY29wZS5jaGFuZ2VBcmVhID0gZnVuY3Rpb24oZXZlbnQsIGVsZW1lbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYXJlYTo6YXJlYVR5cGVDaGFuZ2UnLCBlbGVtZW50LnVybCwgZWxlbWVudC5uYW1lKTtcbiAgICAgIH07ICBcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuYXJlYScpXG4uZGlyZWN0aXZlKCdhcmVhc1RyZWUnLCBbJyRyb290U2NvcGUnLCBmdW5jdGlvbigkcm9vdFNjb3BlKXtcbiAgcmV0dXJuIHtcbiAgICBzY29wZToge1xuICAgICAgdHJlZTpcIj1cIlxuICAgIH0sIC8vIHt9ID0gaXNvbGF0ZSwgdHJ1ZSA9IGNoaWxkLCBmYWxzZS91bmRlZmluZWQgPSBubyBjaGFuZ2VcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnYXJlYS90cmVlL3RyZWUuZGlyLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBpRWxtLCBpQXR0cnMsIGNvbnRyb2xsZXIpIHtcbiAgICAgIHNjb3BlLmFjdGl2ZSA9IC0xO1xuICAgICAgc2NvcGUuYWN0aXZhdGVEZWFjdGl2YXRlID0gZnVuY3Rpb24oZXZlbnQsIGluZGV4KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZihzY29wZS5hY3RpdmUgPT09IC0xKSB7XG4gICAgICAgICAgc2NvcGUuYWN0aXZlID0gaW5kZXg7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNjb3BlLmFjdGl2ZSA9IC0xO1xuICAgICAgfTtcblxuICAgICAgdmFyIGRlcyA9ICRyb290U2NvcGUuJG9uKCdhcmVhOjplbGVjdGlvblR5cGVDaGFuZ2UnLCBmdW5jdGlvbigpe1xuICAgICAgICBzY29wZS5hY3RpdmUgPSAtMTtcbiAgICAgIH0pO1xuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcyk7XG4gICAgICBcbiAgICAgIHZhciBkZXMxID0gJHJvb3RTY29wZS4kb24oJ3RyZWUuY2l0eTo6ZGVhY3RpdmF0ZUFsbEJyYW5jaGVzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgc2NvcGUuYWN0aXZlID0gLTE7XG4gICAgICB9KTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBkZXMxKTtcblxuICAgICAgc2NvcGUuY2hhbmdlQXJlYSA9IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2FyZWE6OmFyZWFUeXBlQ2hhbmdlJywgZWxlbWVudC51cmwsIGVsZW1lbnQubmFtZSk7XG4gICAgICB9O1xuXG4gICAgICBcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmNoYXJ0cy5tYWluQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gIFxuICAkc2NvcGUub3B0aW9ucyA9IHtcbiAgICBjaGFydDoge1xuICAgICAgdHlwZTogJ2Rpc2NyZXRlQmFyQ2hhcnQnLFxuICAgICAgaGVpZ2h0OiA0MDAsXG4gICAgICBtYXJnaW4gOiB7XG4gICAgICAgIHRvcDogMjAsXG4gICAgICAgIHJpZ2h0OiA0MCxcbiAgICAgICAgYm90dG9tOiA1MCxcbiAgICAgICAgbGVmdDogNTVcbiAgICAgIH0sXG4gICAgICB4OiBmdW5jdGlvbihkKXtyZXR1cm4gZC5sYWJlbDt9LFxuICAgICAgeTogZnVuY3Rpb24oZCl7cmV0dXJuIGQudmFsdWU7fSxcbiAgICAgIHNob3dWYWx1ZXM6IGZhbHNlLFxuICAgICAgdmFsdWVGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCcsLjJmJScpKGQpO1xuICAgICAgfSxcbiAgICAgIGR1cmF0aW9uOiA1MDAsXG4gICAgICB4QXhpczoge1xuICAgICAgICAvLyBheGlzTGFiZWw6ICdYIEF4aXMnXG4gICAgICB9LFxuICAgICAgeUF4aXM6IHtcbiAgICAgICAgLy8gYXhpc0xhYmVsOiAnWSBBeGlzJyxcbiAgICAgICAgYXhpc0xhYmVsRGlzdGFuY2U6IDBcbiAgICAgIH0sXG4gICAgfVxuICB9O1xufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5kaXJlY3RpdmUoJ2NoYXJ0c1ZpZXcnLCBbZnVuY3Rpb24oKXtcbiAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBkYXRhOiAnPSdcbiAgICB9LCAvLyB7fSA9IGlzb2xhdGUsIHRydWUgPSBjaGlsZCwgZmFsc2UvdW5kZWZpbmVkID0gbm8gY2hhbmdlXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzLm1haW5DdHJsJyxcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnY2hhcnRzL21haW4vY2hhcnRzLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5jaGFydERhdGEgPSBbe2tleTogXCJDdW11bGF0aXZlIFJldHVyblwiLCB2YWx1ZXM6IFtdfV1cbiAgICAgIHNjb3BlLiR3YXRjaCgnZGF0YScsIGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7XG4gICAgICAgIGlmKHZhbCAhPT0gb2xkVmFsKSB7XG4gICAgICAgICAgc2NvcGUuY2hhcnREYXRhWzBdLnZhbHVlcyA9IF8ubWFwKHZhbC52b3RlcyxmdW5jdGlvbih2KXtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHZhbHVlOiB2LnBlcmNlbnRhZ2UsXG4gICAgICAgICAgICAgIGxhYmVsOiB2LnBvbGl0aWNhbF9wYXJ0eVxuICAgICAgICAgIH19KVxuICAgICAgICAgIHNjb3BlLmNoYXJ0RGF0YVswXS52YWx1ZXMuc29ydChmdW5jdGlvbihhLCBiKXtcbiAgICAgICAgICAgIHJldHVybiBiLnZhbHVlIC0gYS52YWx1ZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQudGFibGVzJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LnRhYmxlcy5tYWluQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgJHNjb3BlLnJvd0NvbGxlY3Rpb24gPSBbXG4gICAge2ZpcnN0TmFtZTogJ0xhdXJlbnQnLCBsYXN0TmFtZTogJ1JlbmFyZCcsIGJpcnRoRGF0ZTogbmV3IERhdGUoJzE5ODctMDUtMjEnKSwgYmFsYW5jZTogMTAyLCBlbWFpbDogJ3doYXRldmVyQGdtYWlsLmNvbSd9LFxuICAgIHtmaXJzdE5hbWU6ICdCbGFuZGluZScsIGxhc3ROYW1lOiAnRmFpdnJlJywgYmlydGhEYXRlOiBuZXcgRGF0ZSgnMTk4Ny0wNC0yNScpLCBiYWxhbmNlOiAtMjMyMy4yMiwgZW1haWw6ICdvdWZibGFuZG91QGdtYWlsLmNvbSd9LFxuICAgIHtmaXJzdE5hbWU6ICdGcmFuY29pc2UnLCBsYXN0TmFtZTogJ0ZyZXJlJywgYmlydGhEYXRlOiBuZXcgRGF0ZSgnMTk1NS0wOC0yNycpLCBiYWxhbmNlOiA0MjM0MywgZW1haWw6ICdyYXltb25kZWZAZ21haWwuY29tJ31cbiAgXTtcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnRhYmxlcycpXG4uZGlyZWN0aXZlKCd0YWJsZXNWaWV3JywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIHN0YXRzOiBcIj1cIixcbiAgICAgIGVsZWN0aW9uS2luZDogXCI9XCJcbiAgICAgIH0sIC8vIHt9ID0gaXNvbGF0ZSwgdHJ1ZSA9IGNoaWxkLCBmYWxzZS91bmRlZmluZWQgPSBubyBjaGFuZ2VcbiAgICBjb250cm9sbGVyOiAnd3lib3J5U2FtMjAxNC50YWJsZXMubWFpbkN0cmwnLFxuICAgIHJlc3RyaWN0OiAnRScsIC8vIEUgPSBFbGVtZW50LCBBID0gQXR0cmlidXRlLCBDID0gQ2xhc3MsIE0gPSBDb21tZW50LFxuICAgIHRlbXBsYXRlVXJsOiAndGFibGVzL21haW4vdGFibGVzLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICAvLyBzY29wZS5jYW5kaWRhdGVzVGFibGVMaW1pdCA9IDMwO1xuICAgIH1cbiAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

"use strict";angular.module("wyborySam2014",["nvd3","smart-table","ui.router","ui.bootstrap","wyborySam2014.area","wyborySam2014.charts","wyborySam2014.tables","wyborySam2014.utils","wyborySam2014.http","wyborySam2014.landingPage"]).constant("DEV_API_PREFIX","http://localhost:8081/api/").constant("HEROKU_API_PREFIX","http://wyreczamy-pkw.herokuapp.com/api/"),angular.module("wyborySam2014").config(["$stateProvider",function(t){t.state("stats-app",{url:"/app/{dataUrl}",controller:"wyborySam2014.area.ctrl",templateUrl:"area/area.ctrl.html"}).state("landing",{url:"",controller:"wyborySam2014.landing.ctrl",templateUrl:"landing_page/landing.ctrl.html"})}]),angular.module("wyborySam2014.area",[]),angular.module("wyborySam2014.area").controller("wyborySam2014.area.ctrl",["$scope","$rootScope","$http","$stateParams","httpService","urls",function(t,a,e,r,n,o){var i=function(a){var e=a.filter(function(a){return a.type===t.electionKind.type})[0];return e},l=function(a,e){t.showSpinner=!0,n.getStatsData(a).success(function(r){t.stats=r,t.siteName=e,o.changeDataUrl(a,t.dataUrl,"stats"),t.showSpinner=!1})};t.chartData={key:"",values:[]},t.dataUrl=r.dataUrl,t.showSpinner=!1,n.getAreasTree().success(function(a){t.tree=a;var e=o.decode(r.dataUrl),n=o.getSiteName(e);t.electionKind=o.getElectionKind(a,e),t.navTree=i(a),l(e,n)}),t.$watch("electionKind",function(e,r){e!==r&&void 0!==r&&(t.navTree=i(t.tree),a.$broadcast("area::electionTypeChange"),l(t.electionKind.url,"Warszawa"))});var c=a.$on("area::areaTypeChange",function(t,a,e){l(a,e)});t.$on("$destroy",c),t.menuIsVisible=function(){return t.openMenu===!1||t.openMenu===!0},t.menuIsOff=function(){return t.openMenu===!1},t.dropdownIsOff=function(){return t.electionKindsDropwn===!1},t.dropdownIsVisible=function(){return t.electionKindsDropwn===!1||t.electionKindsDropwn===!0},t.changeElectionKind=function(a){t.dataUrl=a.url,t.electionKind={name:a.name,type:a.type,url:a.url},n.getStatsData(a.url).success(function(a){t.statsData=a}),o.changeDataUrl(a.url,"stats"),t.electionKindsDropwn=!1},t.scrollTo=function(t){return"#charts"===t?void $(t).velocity("scroll",{axis:"y",offset:-140}):void $(t).velocity("scroll",{axis:"y",offset:-60})}}]),angular.module("wyborySam2014.charts",[]),angular.module("wyborySam2014.http",[]),angular.module("wyborySam2014.http").factory("httpService",["$http","DEV_API_PREFIX","HEROKU_API_PREFIX",function(t,a,e){var r={};return r.getAreasTree=function(){return t.get(e+"stats/areas-tree/")},r.getStatsData=function(a){return t.get(e+a)},r}]),angular.module("wyborySam2014.utils",[]),angular.module("wyborySam2014.utils").factory("urls",["$location",function(t){var a={};return a.code=function(t){return t.replace(/\//g,".")},a.decode=function(t){return t.replace(/\./g,"/")},a.getSiteName=function(t,a){if(t)var e=t.split(a||"/"),r=e[e.length-2].split("-");return t&&"circle"===r[0]?"Okręg nr "+r[1]:t&&"circuit"===r[0]?"Obwód nr "+r[1]:t&&"district"===r[0]?r[1]:"Warszawa"},a.getElectionKind=function(t,a,e){if(!a||!t)return{name:"Wybory do Rady Miasta",type:"city_council",url:"stats/city_council/"};var r=a.split(e||"/")[1],n=t.filter(function(t){return t.type===r})[0];return{name:n.name,type:n.type,url:n.url}},a.changeDataUrl=function(e,r,n){var o=t.path().split("/");o.pop(),o.push(a.code(e)),t.path(o.join("/"))},a}]),angular.module("wyborySam2014.tables",[]),angular.module("wyborySam2014.landingPage",[]),angular.module("wyborySam2014.landingPage").controller("wyborySam2014.landing.ctrl",["$scope","$state","httpService","urls",function(t,a,e,r){e.getAreasTree().success(function(a){t.tree=a}),t.data=null,t.gotoStats=function(t){t||(t="stats/city_council/circle-1/"),a.go("stats-app",{dataUrl:r.code(t)})}}]),angular.module("wyborySam2014.area").directive("mainCity",["$rootScope",function(t){return{scope:{election:"="},restrict:"E",templateUrl:"area/tree/main-city.dir.html",link:function(a,e,r,n){a.deactivateAllBranches=function(a,e){a.stopPropagation(),t.$broadcast("tree.city::deactivateAllBranches")},a.changeArea=function(a,e){a.stopPropagation(),t.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.area").directive("areasTree",["$rootScope",function(t){return{scope:{tree:"="},restrict:"E",templateUrl:"area/tree/tree.dir.html",link:function(a,e,r,n){a.active=-1,a.activateDeactivate=function(t,e){return t.stopPropagation(),-1===a.active?void(a.active=e):void(a.active=-1)};var o=t.$on("area::electionTypeChange",function(){a.active=-1});a.$on("$destroy",o);var i=t.$on("tree.city::deactivateAllBranches",function(){a.active=-1});a.$on("$destroy",i),a.changeArea=function(a,e){a.stopPropagation(),t.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.tables").controller("wyborySam2014.tables.mainCtrl",["$scope",function(t){t.rowCollection=[{firstName:"Laurent",lastName:"Renard",birthDate:new Date("1987-05-21"),balance:102,email:"whatever@gmail.com"},{firstName:"Blandine",lastName:"Faivre",birthDate:new Date("1987-04-25"),balance:-2323.22,email:"oufblandou@gmail.com"},{firstName:"Francoise",lastName:"Frere",birthDate:new Date("1955-08-27"),balance:42343,email:"raymondef@gmail.com"}]}]),angular.module("wyborySam2014.tables").directive("tablesView",[function(){return{scope:{stats:"=",electionKind:"="},controller:"wyborySam2014.tables.mainCtrl",restrict:"E",templateUrl:"tables/main/tables.dir.html",link:function(t,a,e,r){}}}]),angular.module("wyborySam2014.charts").controller("wyborySam2014.charts.mainCtrl",["$scope",function(t){t.options={chart:{type:"discreteBarChart",height:400,margin:{top:20,right:40,bottom:50,left:55},x:function(t){return t.label},y:function(t){return t.value},showValues:!1,valueFormat:function(t){return d3.format(",.2f%")(t)},duration:500,xAxis:{},yAxis:{axisLabelDistance:0}}}}]),angular.module("wyborySam2014.charts").directive("chartsView",[function(){return{scope:{data:"="},controller:"wyborySam2014.charts.mainCtrl",restrict:"E",templateUrl:"charts/main/charts.dir.html",link:function(t,a,e,r){t.chartData=[{key:"Cumulative Return",values:[]}],t.$watch("data",function(a,e){a!==e&&(t.chartData[0].values=_.map(a.votes,function(t){return{value:t.percentage,label:t.political_party}}),t.chartData[0].values.sort(function(t,a){return a.value-t.value}))})}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvYXBwLmpzIiwiL3NvdXJjZS9jb25maWcuanMiLCIvc291cmNlL2FyZWEvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2FyZWEvYXJlYS5jdHJsLmpzIiwiL3NvdXJjZS9jaGFydHMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvaHR0cC5mYWN0LmpzIiwiL3NvdXJjZS91dGlscy9fZGVmaW5pdGlvbi5qcyIsIi9zb3VyY2UvdXRpbHMvZGF0YS11cmxzLmZhY3QuanMiLCIvc291cmNlL3RhYmxlcy9fZGVmaW5pdGlvbi5qcyIsIi9zb3VyY2UvbGFuZGluZ19wYWdlL19kZWZpbml0aW9uLmpzIiwiL3NvdXJjZS9sYW5kaW5nX3BhZ2UvbGFuZGluZy5jdHJsLmpzIiwiL3NvdXJjZS9hcmVhL3RyZWUvbWFpbi1jaXR5LmRpci5qcyIsIi9zb3VyY2UvYXJlYS90cmVlL3RyZWUuZGlyLmpzIiwiL3NvdXJjZS90YWJsZXMvbWFpbi90YWJsZXMuY3RybC5qcyIsIi9zb3VyY2UvdGFibGVzL21haW4vdGFibGVzLmRpci5qcyIsIi9zb3VyY2UvY2hhcnRzL21haW4vY2hhcnRzLmN0cmwuanMiLCIvc291cmNlL2NoYXJ0cy9tYWluL2NoYXJ0cy5kaXIuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsIiRzY29wZSIsIiRyb290U2NvcGUiLCIkaHR0cCIsIiRzdGF0ZVBhcmFtcyIsImh0dHBTZXJ2aWNlIiwidXJscyIsImdldE5hdlRyZWUiLCJ0cmVlIiwib25lVHJlZSIsImZpbHRlciIsIm9iaiIsInR5cGUiLCJlbGVjdGlvbktpbmQiLCJnZXREYXRhIiwibmFtZSIsInNob3dTcGlubmVyIiwiZ2V0U3RhdHNEYXRhIiwic3VjY2VzcyIsInN0YXRzIiwic2l0ZU5hbWUiLCJjaGFuZ2VEYXRhVXJsIiwiZGF0YVVybCIsImNoYXJ0RGF0YSIsImtleSIsInZhbHVlcyIsImdldEFyZWFzVHJlZSIsImRlY29kZSIsImdldFNpdGVOYW1lIiwiZ2V0RWxlY3Rpb25LaW5kIiwibmF2VHJlZSIsIiR3YXRjaCIsInZhbCIsIm9sZFZhbCIsInVuZGVmaW5lZCIsIiRicm9hZGNhc3QiLCJkZXMiLCIkb24iLCJlIiwibWVudUlzVmlzaWJsZSIsIm9wZW5NZW51IiwibWVudUlzT2ZmIiwiZHJvcGRvd25Jc09mZiIsImVsZWN0aW9uS2luZHNEcm9wd24iLCJkcm9wZG93bklzVmlzaWJsZSIsImNoYW5nZUVsZWN0aW9uS2luZCIsImtpbmQiLCJkYXRhIiwic3RhdHNEYXRhIiwic2Nyb2xsVG8iLCIkIiwidmVsb2NpdHkiLCJheGlzIiwib2Zmc2V0IiwiZmFjdG9yeSIsIkRFVl9BUElfUFJFRklYIiwiSEVST0tVX0FQSV9QUkVGSVgiLCJzZWxmIiwiZ2V0IiwiJGxvY2F0aW9uIiwiY29kZSIsInJlcGxhY2UiLCJzcGxpdFVybFBhcmFtIiwidXJsc0FyciIsInNwbGl0IiwiZGF0YVR5cGUiLCJsZW5ndGgiLCJub2RlIiwiU3RhdGVQYXJhbURhdGFVcmwiLCJzaXRlVHlwZSIsInBhdGgiLCJwb3AiLCJwdXNoIiwiam9pbiIsIiRzdGF0ZSIsImdvdG9TdGF0cyIsImdvIiwiZGlyZWN0aXZlIiwic2NvcGUiLCJlbGVjdGlvbiIsInJlc3RyaWN0IiwibGluayIsImlFbG0iLCJpQXR0cnMiLCJkZWFjdGl2YXRlQWxsQnJhbmNoZXMiLCJldmVudCIsImVsZW1lbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJjaGFuZ2VBcmVhIiwiYWN0aXZlIiwiYWN0aXZhdGVEZWFjdGl2YXRlIiwiaW5kZXgiLCJkZXMxIiwicm93Q29sbGVjdGlvbiIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYmlydGhEYXRlIiwiRGF0ZSIsImJhbGFuY2UiLCJlbWFpbCIsIm9wdGlvbnMiLCJjaGFydCIsImhlaWdodCIsIm1hcmdpbiIsInRvcCIsInJpZ2h0IiwiYm90dG9tIiwibGVmdCIsIngiLCJkIiwibGFiZWwiLCJ5IiwidmFsdWUiLCJzaG93VmFsdWVzIiwidmFsdWVGb3JtYXQiLCJkMyIsImZvcm1hdCIsImR1cmF0aW9uIiwieEF4aXMiLCJ5QXhpcyIsImF4aXNMYWJlbERpc3RhbmNlIiwiXyIsIm1hcCIsInZvdGVzIiwidiIsInBlcmNlbnRhZ2UiLCJwb2xpdGljYWxfcGFydHkiLCJzb3J0IiwiYSIsImIiXSwibWFwcGluZ3MiOiJBQUFBLFlBQ0FBLFNBQUFDLE9BQUEsaUJBQ0EsT0FDQSxjQUNBLFlBQ0EsZUFDQSxxQkFDQSx1QkFDQSx1QkFDQSxzQkFDQSxxQkFDQSw4QkFFQUMsU0FBQSxpQkFBQSw4QkFDQUEsU0FBQSxvQkFBQSwyQ0NkQUYsUUFBQUMsT0FBQSxpQkFDQUUsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUNBQyxNQUFBLGFBQ0FDLElBQUEsaUJBQ0FDLFdBQUEsMEJBQ0FDLFlBQUEsd0JBRUFILE1BQUEsV0FDQUMsSUFBQSxHQUNBQyxXQUFBLDZCQUNBQyxZQUFBLHNDQ1ZBUixRQUFBQyxPQUFBLHlCQ0RBRCxRQUFBQyxPQUFBLHNCQUNBTSxXQUFBLDJCQUFBLFNBQUEsYUFBQSxRQUFBLGVBQUEsY0FBQSxPQUNBLFNBQUFFLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUFFLE9BQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUFBQyxPQUFBWCxFQUFBWSxhQUFBRCxPQUNBLEVBQ0EsT0FBQUgsSUFHQUssRUFBQSxTQUFBaEIsRUFBQWlCLEdBQ0FkLEVBQUFlLGFBQUEsRUFDQVgsRUFBQVksYUFBQW5CLEdBQUFvQixRQUFBLFNBQUFDLEdBQ0FsQixFQUFBa0IsTUFBQUEsRUFDQWxCLEVBQUFtQixTQUFBTCxFQUNBVCxFQUFBZSxjQUFBdkIsRUFBQUcsRUFBQXFCLFFBQUEsU0FDQXJC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QUEsS0FFQWQsV0FBQSxnQ0FDQWlGLFNBQUEsSUFDQWhGLFlBQUEsOEJBQ0FpRixLQUFBLFNBQUFILEVBQUFJLEVBQUFDLEVBQUFwRixTQ1ZBUCxRQUFBQyxPQUFBLHdCQUNBTSxXQUFBLGlDQUFBLFNBQUEsU0FBQUUsR0FFQUEsRUFBQW1HLFNBQ0FDLE9BQ0F6RixLQUFBLG1CQUNBMEYsT0FBQSxJQUNBQyxRQUNBQyxJQUFBLEdBQ0FDLE1BQUEsR0FDQUMsT0FBQSxHQUNBQyxLQUFBLElBRUFDLEVBQUEsU0FBQUMsR0FBQSxNQUFBQSxHQUFBQyxPQUNBQyxFQUFBLFNBQUFGLEdBQUEsTUFBQUEsR0FBQUcsT0FDQUMsWUFBQSxFQUNBQyxZQUFBLFNBQUFMLEdBQ0EsTUFBQU0sSUFBQUMsT0FBQSxTQUFBUCxJQUVBUSxTQUFBLElBQ0FDLFNBR0FDLE9BRUFDLGtCQUFBLFFDekJBaEksUUFBQUMsT0FBQSx3QkFDQW9GLFVBQUEsY0FBQSxXQUVBLE9BQ0FDLE9BQ0EvQixLQUFBLEtBRUFoRCxXQUFBLGdDQUNBaUYsU0FBQSxJQUNBaEYsWUFBQSw4QkFDQWlGLEtBQUEsU0FBQUgsRUFBQUksRUFBQUMsRUFBQXBGLEdBQ0ErRSxFQUFBdkQsWUFBQUMsSUFBQSxvQkFBQUMsWUFDQXFELEVBQUEvQyxPQUFBLE9BQUEsU0FBQUMsRUFBQUMsR0FDQUQsSUFBQUMsSUFDQTZDLEVBQUF2RCxVQUFBLEdBQUFFLE9BQUFnRyxFQUFBQyxJQUFBMUYsRUFBQTJGLE1BQUEsU0FBQUMsR0FDQSxPQUNBWixNQUFBWSxFQUFBQyxXQUNBZixNQUFBYyxFQUFBRSxtQkFFQWhELEVBQUF2RCxVQUFBLEdBQUFFLE9BQUFzRyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUEsR0FBQWpCLE1BQUFnQixFQUFBaEIiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0JywgW1xuICAnbnZkMycsXG4gICdzbWFydC10YWJsZScsXG4gICd1aS5yb3V0ZXInLFxuICAndWkuYm9vdHN0cmFwJyxcbiAgJ3d5Ym9yeVNhbTIwMTQuYXJlYScsXG4gICd3eWJvcnlTYW0yMDE0LmNoYXJ0cycsXG4gICd3eWJvcnlTYW0yMDE0LnRhYmxlcycsXG4gICd3eWJvcnlTYW0yMDE0LnV0aWxzJyxcbiAgJ3d5Ym9yeVNhbTIwMTQuaHR0cCcsXG4gICd3eWJvcnlTYW0yMDE0LmxhbmRpbmdQYWdlJ1xuICBdKVxuLmNvbnN0YW50KCdERVZfQVBJX1BSRUZJWCcsICdodHRwOi8vbG9jYWxob3N0OjgwODEvYXBpLycpXG4uY29uc3RhbnQoJ0hFUk9LVV9BUElfUFJFRklYJywgJ2h0dHA6Ly93eXJlY3phbXktcGt3Lmhlcm9rdWFwcC5jb20vYXBpLycpOyIsImFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0Jylcbi5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICRzdGF0ZVByb3ZpZGVyXG4gIC5zdGF0ZSgnc3RhdHMtYXBwJywge1xuICAgIHVybDogJy9hcHAve2RhdGFVcmx9JyxcbiAgICBjb250cm9sbGVyOiAnd3lib3J5U2FtMjAxNC5hcmVhLmN0cmwnLFxuICAgIHRlbXBsYXRlVXJsOiAnYXJlYS9hcmVhLmN0cmwuaHRtbCdcbiAgfSlcbiAgLnN0YXRlKCdsYW5kaW5nJywge1xuICAgIHVybDogJycsXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQubGFuZGluZy5jdHJsJyxcbiAgICB0ZW1wbGF0ZVVybDogJ2xhbmRpbmdfcGFnZS9sYW5kaW5nLmN0cmwuaHRtbCdcbiAgfSlcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmFyZWEnLCBbXSkiLCJhbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5hcmVhJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmFyZWEuY3RybCcsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGh0dHAnLCAnJHN0YXRlUGFyYW1zJywgJ2h0dHBTZXJ2aWNlJywgJ3VybHMnLFxuICBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIGh0dHBTZXJ2aWNlLCB1cmxzKXtcbiAgdmFyIGdldE5hdlRyZWUgPSBmdW5jdGlvbih0cmVlKSB7XG4gICAgdmFyIG9uZVRyZWUgPSB0cmVlLmZpbHRlcihmdW5jdGlvbihvYmope1xuICAgICAgcmV0dXJuIG9iai50eXBlID09PSAkc2NvcGUuZWxlY3Rpb25LaW5kLnR5cGU7XG4gICAgfSlbMF07XG4gICAgcmV0dXJuIG9uZVRyZWU7XG4gIH07XG5cbiAgdmFyIGdldERhdGEgPSBmdW5jdGlvbiAodXJsLCBuYW1lKSB7XG4gICAgJHNjb3BlLnNob3dTcGlubmVyID0gdHJ1ZTtcbiAgICBodHRwU2VydmljZS5nZXRTdGF0c0RhdGEodXJsKS5zdWNjZXNzKGZ1bmN0aW9uKHN0YXRzKXtcbiAgICAgICRzY29wZS5zdGF0cyA9IHN0YXRzO1xuICAgICAgJHNjb3BlLnNpdGVOYW1lID0gbmFtZTtcbiAgICAgIHVybHMuY2hhbmdlRGF0YVVybCh1cmwsICRzY29wZS5kYXRhVXJsLCAnc3RhdHMnKTtcbiAgICAgICRzY29wZS5zaG93U3Bpbm5lciA9IGZhbHNlO1xuICAgIH0pXG4gIH07XG5cbiAgJHNjb3BlLmNoYXJ0RGF0YSA9IHtrZXk6ICcnLCB2YWx1ZXM6IFtdfTtcbiAgJHNjb3BlLmRhdGFVcmwgPSAkc3RhdGVQYXJhbXMuZGF0YVVybDtcbiAgJHNjb3BlLnNob3dTcGlubmVyID0gZmFsc2U7XG5cbiAgaHR0cFNlcnZpY2UuZ2V0QXJlYXNUcmVlKCkuc3VjY2VzcyhmdW5jdGlvbih0cmVlKSB7XG4gICAgJHNjb3BlLnRyZWUgPSB0cmVlO1xuICAgIFxuICAgIHZhciB1cmwgPSB1cmxzLmRlY29kZSgkc3RhdGVQYXJhbXMuZGF0YVVybCk7XG4gICAgdmFyIG5hbWUgPSB1cmxzLmdldFNpdGVOYW1lKHVybCk7XG4gICAgLy8gY29uc29sZS5sb2coKTtcbiAgICAkc2NvcGUuZWxlY3Rpb25LaW5kID0gdXJscy5nZXRFbGVjdGlvbktpbmQodHJlZSwgdXJsKTtcbiAgICAkc2NvcGUubmF2VHJlZSA9IGdldE5hdlRyZWUodHJlZSk7XG4gICAgZ2V0RGF0YSh1cmwsIG5hbWUpO1xuICB9KTtcblxuICAkc2NvcGUuJHdhdGNoKCdlbGVjdGlvbktpbmQnLCBmdW5jdGlvbih2YWwsIG9sZFZhbCkge1xuICAgIGlmKHZhbCAhPT0gb2xkVmFsICYmIG9sZFZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAkc2NvcGUubmF2VHJlZSA9IGdldE5hdlRyZWUoJHNjb3BlLnRyZWUpO1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhcmVhOjplbGVjdGlvblR5cGVDaGFuZ2UnKTtcbiAgICAgIGdldERhdGEoJHNjb3BlLmVsZWN0aW9uS2luZC51cmwsICdXYXJzemF3YScpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGRlcyA9ICRyb290U2NvcGUuJG9uKCdhcmVhOjphcmVhVHlwZUNoYW5nZScsIGZ1bmN0aW9uKGUsIHVybCwgbmFtZSl7XG4gICAgZ2V0RGF0YSh1cmwsIG5hbWUpXG4gIH0pO1xuICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcyk7XG5cbiAgJHNjb3BlLm1lbnVJc1Zpc2libGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLm9wZW5NZW51ID09PSBmYWxzZSB8fCAkc2NvcGUub3Blbk1lbnUgPT09IHRydWU7XG4gIH07XG4gICRzY29wZS5tZW51SXNPZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLm9wZW5NZW51ID09PSBmYWxzZTtcbiAgfTtcbiAgXG4gICRzY29wZS5kcm9wZG93bklzT2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID09PSBmYWxzZTtcbiAgfTtcblxuICAkc2NvcGUuZHJvcGRvd25Jc1Zpc2libGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLmVsZWN0aW9uS2luZHNEcm9wd24gPT09IGZhbHNlIHx8ICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID09PSB0cnVlO1xuICB9O1xuXG4gICRzY29wZS5jaGFuZ2VFbGVjdGlvbktpbmQgPSBmdW5jdGlvbihraW5kKSB7XG4gICAgJHNjb3BlLmRhdGFVcmwgPSBraW5kLnVybDtcbiAgICAkc2NvcGUuZWxlY3Rpb25LaW5kID0ge1xuICAgICAgbmFtZToga2luZC5uYW1lLFxuICAgICAgdHlwZToga2luZC50eXBlLFxuICAgICAgdXJsOiBraW5kLnVybFxuICAgIH07XG4gICAgaHR0cFNlcnZpY2UuZ2V0U3RhdHNEYXRhKGtpbmQudXJsKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgJHNjb3BlLnN0YXRzRGF0YSA9IGRhdGE7XG4gICAgfSlcbiAgICB1cmxzLmNoYW5nZURhdGFVcmwoa2luZC51cmwsICdzdGF0cycpO1xuICAgICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID0gZmFsc2U7XG4gIH07XG4gIFxuICAkc2NvcGUuc2Nyb2xsVG8gPSBmdW5jdGlvbihraW5kKSB7XG4gICAgaWYoa2luZCA9PT0gJyNjaGFydHMnKSB7XG4gICAgICAkKGtpbmQpLnZlbG9jaXR5KFwic2Nyb2xsXCIsIHsgYXhpczogXCJ5XCIsIG9mZnNldDogLTE0MH0pXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgICQoa2luZCkudmVsb2NpdHkoXCJzY3JvbGxcIiwgeyBheGlzOiBcInlcIiwgb2Zmc2V0OiAtNjB9KVxuXG5cbiAgfVxuXG4gIFxuICBcbn1dKTsiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5jaGFydHMnLCBbXSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5odHRwJywgW10pIiwiYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuaHR0cCcpXG4uZmFjdG9yeSgnaHR0cFNlcnZpY2UnLCBbJyRodHRwJywgJ0RFVl9BUElfUFJFRklYJywgJ0hFUk9LVV9BUElfUFJFRklYJywgZnVuY3Rpb24oJGh0dHAsIERFVl9BUElfUFJFRklYLCBIRVJPS1VfQVBJX1BSRUZJWCkge1xuICB2YXIgc2VsZiA9IHt9O1xuICBcbiAgc2VsZi5nZXRBcmVhc1RyZWUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KEhFUk9LVV9BUElfUFJFRklYICsgJ3N0YXRzL2FyZWFzLXRyZWUvJyk7XG4gIH07XG5cbiAgc2VsZi5nZXRTdGF0c0RhdGEgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KEhFUk9LVV9BUElfUFJFRklYICsgdXJsKTtcbiAgfTtcblxuICByZXR1cm4gc2VsZjtcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnV0aWxzJywgW10pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQudXRpbHMnKVxuLmZhY3RvcnkoJ3VybHMnLCBbJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRsb2NhdGlvbil7XG4gIHZhciBzZWxmID0ge307XG4gIFxuICBzZWxmLmNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLy9nLCAnLicpO1xuICB9O1xuICBcbiAgc2VsZi5kZWNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLi9nLCAnLycpO1xuICB9O1xuXG4gIHNlbGYuZ2V0U2l0ZU5hbWUgPSBmdW5jdGlvbih1cmwsIHNwbGl0VXJsUGFyYW0pIHtcbiAgICBpZih1cmwpIHtcbiAgICAgIHZhciB1cmxzQXJyID0gdXJsLnNwbGl0KHNwbGl0VXJsUGFyYW0gfHwgJy8nKTtcbiAgICAgIHZhciBkYXRhVHlwZSA9IHVybHNBcnJbdXJsc0Fyci5sZW5ndGggLSAyXS5zcGxpdCgnLScpOyAgXG4gICAgfVxuXG4gICAgaWYodXJsICYmIGRhdGFUeXBlWzBdID09PSAnY2lyY2xlJykge1xuICAgICAgcmV0dXJuICdPa3LEmWcgbnIgJyArIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2NpcmN1aXQnKSB7XG4gICAgICByZXR1cm4gJ09id8OzZCBuciAnICsgIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2Rpc3RyaWN0Jykge1xuICAgICAgcmV0dXJuIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiAnV2Fyc3phd2EnO1xuICAgIH1cbiAgfTtcblxuICBzZWxmLmdldEVsZWN0aW9uS2luZCA9IGZ1bmN0aW9uKHRyZWUsIHVybCwgc3BsaXRVcmxQYXJhbSkge1xuICAgIGlmKCF1cmwgfHwgIXRyZWUpIHtcbiAgICAgIHJldHVybiB7IC8vZGVmYXVsdCBkYXRhXG4gICAgICAgIG5hbWU6ICdXeWJvcnkgZG8gUmFkeSBNaWFzdGEnLFxuICAgICAgICB0eXBlOiAnY2l0eV9jb3VuY2lsJyxcbiAgICAgICAgdXJsOiAnc3RhdHMvY2l0eV9jb3VuY2lsLydcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdHlwZSA9IHVybC5zcGxpdChzcGxpdFVybFBhcmFtIHx8ICcvJylbMV07XG4gICAgdmFyIG5vZGUgPSB0cmVlLmZpbHRlcihmdW5jdGlvbihvYmope1xuICAgICAgcmV0dXJuIG9iai50eXBlID09PSB0eXBlO1xuICAgIH0pWzBdO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBub2RlLm5hbWUsXG4gICAgICB0eXBlOiBub2RlLnR5cGUsXG4gICAgICB1cmw6IG5vZGUudXJsXG4gICAgfTtcbiAgfVxuXG4gIHNlbGYuY2hhbmdlRGF0YVVybCA9IGZ1bmN0aW9uKHVybCwgU3RhdGVQYXJhbURhdGFVcmwsIHNpdGVUeXBlKSB7XG4gICAgXG4gICAgdmFyIGRhdGFVcmwgPSAkbG9jYXRpb24ucGF0aCgpLnNwbGl0KCcvJyk7XG4gICAgXG4gICAgLy9pdCBpcyBkYW5nZXJvdXMgYnV0IG5vdyB3b3JrcyBcbiAgICBkYXRhVXJsLnBvcCgpO1xuICAgIFxuICAgIGRhdGFVcmwucHVzaChzZWxmLmNvZGUodXJsKSk7XG4gICAgJGxvY2F0aW9uLnBhdGgoZGF0YVVybC5qb2luKCcvJykpO1xuICB9XG5cbiAgcmV0dXJuIHNlbGY7XG59XSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC50YWJsZXMnLCBbXSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5sYW5kaW5nUGFnZScsIFtdKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmxhbmRpbmdQYWdlJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmxhbmRpbmcuY3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZScsJ2h0dHBTZXJ2aWNlJywgJ3VybHMnLFxuZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIGh0dHBTZXJ2aWNlLCB1cmxzKXtcbiAgaHR0cFNlcnZpY2UuZ2V0QXJlYXNUcmVlKCkuc3VjY2VzcyhmdW5jdGlvbih0cmVlKSB7XG4gICAgJHNjb3BlLnRyZWUgPSB0cmVlO1xuICB9KTtcbiAgJHNjb3BlLmRhdGEgPSBudWxsO1xuICAkc2NvcGUuZ290b1N0YXRzID0gZnVuY3Rpb24odXJsKSB7XG4gICAgaWYoIXVybCkge1xuICAgICAgdXJsID0gJ3N0YXRzL2NpdHlfY291bmNpbC9jaXJjbGUtMS8nO1xuICAgIH1cbiAgICAkc3RhdGUuZ28oJ3N0YXRzLWFwcCcsIHtkYXRhVXJsOiB1cmxzLmNvZGUodXJsKX0pO1xuICB9O1xufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuYXJlYScpXG4uZGlyZWN0aXZlKCdtYWluQ2l0eScsIFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRyb290U2NvcGUpe1xuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBlbGVjdGlvbjpcIj1cIlxuICAgIH0sIC8vIHt9ID0gaXNvbGF0ZSwgdHJ1ZSA9IGNoaWxkLCBmYWxzZS91bmRlZmluZWQgPSBubyBjaGFuZ2VcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnYXJlYS90cmVlL21haW4tY2l0eS5kaXIuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGlFbG0sIGlBdHRycywgY29udHJvbGxlcikge1xuICAgICAgc2NvcGUuZGVhY3RpdmF0ZUFsbEJyYW5jaGVzID0gZnVuY3Rpb24oZXZlbnQsIGVsZW1lbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgndHJlZS5jaXR5OjpkZWFjdGl2YXRlQWxsQnJhbmNoZXMnKSBcbiAgICAgIH1cblxuICAgICAgc2NvcGUuY2hhbmdlQXJlYSA9IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2FyZWE6OmFyZWFUeXBlQ2hhbmdlJywgZWxlbWVudC51cmwsIGVsZW1lbnQubmFtZSk7XG4gICAgICB9OyAgXG4gICAgfVxuICB9O1xufV0pOyIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmFyZWEnKVxuLmRpcmVjdGl2ZSgnYXJlYXNUcmVlJywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSl7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIHRyZWU6XCI9XCJcbiAgICB9LCAvLyB7fSA9IGlzb2xhdGUsIHRydWUgPSBjaGlsZCwgZmFsc2UvdW5kZWZpbmVkID0gbm8gY2hhbmdlXG4gICAgcmVzdHJpY3Q6ICdFJywgLy8gRSA9IEVsZW1lbnQsIEEgPSBBdHRyaWJ1dGUsIEMgPSBDbGFzcywgTSA9IENvbW1lbnRcbiAgICB0ZW1wbGF0ZVVybDogJ2FyZWEvdHJlZS90cmVlLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5hY3RpdmUgPSAtMTtcbiAgICAgIHNjb3BlLmFjdGl2YXRlRGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKGV2ZW50LCBpbmRleCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgaWYoc2NvcGUuYWN0aXZlID09PSAtMSkge1xuICAgICAgICAgIHNjb3BlLmFjdGl2ZSA9IGluZGV4O1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzY29wZS5hY3RpdmUgPSAtMTtcbiAgICAgIH07XG5cbiAgICAgIHZhciBkZXMgPSAkcm9vdFNjb3BlLiRvbignYXJlYTo6ZWxlY3Rpb25UeXBlQ2hhbmdlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgc2NvcGUuYWN0aXZlID0gLTE7XG4gICAgICB9KTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBkZXMpO1xuICAgICAgXG4gICAgICB2YXIgZGVzMSA9ICRyb290U2NvcGUuJG9uKCd0cmVlLmNpdHk6OmRlYWN0aXZhdGVBbGxCcmFuY2hlcycsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHNjb3BlLmFjdGl2ZSA9IC0xO1xuICAgICAgfSk7XG4gICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZGVzMSk7XG5cbiAgICAgIHNjb3BlLmNoYW5nZUFyZWEgPSBmdW5jdGlvbihldmVudCwgZWxlbWVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhcmVhOjphcmVhVHlwZUNoYW5nZScsIGVsZW1lbnQudXJsLCBlbGVtZW50Lm5hbWUpO1xuICAgICAgfTtcblxuICAgICAgXG4gICAgfVxuICB9O1xufV0pOyIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnRhYmxlcycpXG4uY29udHJvbGxlcignd3lib3J5U2FtMjAxNC50YWJsZXMubWFpbkN0cmwnLCBbJyRzY29wZScsIGZ1bmN0aW9uKCRzY29wZSl7XG4gICRzY29wZS5yb3dDb2xsZWN0aW9uID0gW1xuICAgIHtmaXJzdE5hbWU6ICdMYXVyZW50JywgbGFzdE5hbWU6ICdSZW5hcmQnLCBiaXJ0aERhdGU6IG5ldyBEYXRlKCcxOTg3LTA1LTIxJyksIGJhbGFuY2U6IDEwMiwgZW1haWw6ICd3aGF0ZXZlckBnbWFpbC5jb20nfSxcbiAgICB7Zmlyc3ROYW1lOiAnQmxhbmRpbmUnLCBsYXN0TmFtZTogJ0ZhaXZyZScsIGJpcnRoRGF0ZTogbmV3IERhdGUoJzE5ODctMDQtMjUnKSwgYmFsYW5jZTogLTIzMjMuMjIsIGVtYWlsOiAnb3VmYmxhbmRvdUBnbWFpbC5jb20nfSxcbiAgICB7Zmlyc3ROYW1lOiAnRnJhbmNvaXNlJywgbGFzdE5hbWU6ICdGcmVyZScsIGJpcnRoRGF0ZTogbmV3IERhdGUoJzE5NTUtMDgtMjcnKSwgYmFsYW5jZTogNDIzNDMsIGVtYWlsOiAncmF5bW9uZGVmQGdtYWlsLmNvbSd9XG4gIF07XG59XSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC50YWJsZXMnKVxuLmRpcmVjdGl2ZSgndGFibGVzVmlldycsIFtmdW5jdGlvbigpe1xuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBzdGF0czogXCI9XCIsXG4gICAgICBlbGVjdGlvbktpbmQ6IFwiPVwiXG4gICAgICB9LCAvLyB7fSA9IGlzb2xhdGUsIHRydWUgPSBjaGlsZCwgZmFsc2UvdW5kZWZpbmVkID0gbm8gY2hhbmdlXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQudGFibGVzLm1haW5DdHJsJyxcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudCxcbiAgICB0ZW1wbGF0ZVVybDogJ3RhYmxlcy9tYWluL3RhYmxlcy5kaXIuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGlFbG0sIGlBdHRycywgY29udHJvbGxlcikge1xuICAgICAgLy8gc2NvcGUuY2FuZGlkYXRlc1RhYmxlTGltaXQgPSAzMDtcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmNoYXJ0cy5tYWluQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gIFxuICAkc2NvcGUub3B0aW9ucyA9IHtcbiAgICBjaGFydDoge1xuICAgICAgdHlwZTogJ2Rpc2NyZXRlQmFyQ2hhcnQnLFxuICAgICAgaGVpZ2h0OiA0MDAsXG4gICAgICBtYXJnaW4gOiB7XG4gICAgICAgIHRvcDogMjAsXG4gICAgICAgIHJpZ2h0OiA0MCxcbiAgICAgICAgYm90dG9tOiA1MCxcbiAgICAgICAgbGVmdDogNTVcbiAgICAgIH0sXG4gICAgICB4OiBmdW5jdGlvbihkKXtyZXR1cm4gZC5sYWJlbDt9LFxuICAgICAgeTogZnVuY3Rpb24oZCl7cmV0dXJuIGQudmFsdWU7fSxcbiAgICAgIHNob3dWYWx1ZXM6IGZhbHNlLFxuICAgICAgdmFsdWVGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCcsLjJmJScpKGQpO1xuICAgICAgfSxcbiAgICAgIGR1cmF0aW9uOiA1MDAsXG4gICAgICB4QXhpczoge1xuICAgICAgICAvLyBheGlzTGFiZWw6ICdYIEF4aXMnXG4gICAgICB9LFxuICAgICAgeUF4aXM6IHtcbiAgICAgICAgLy8gYXhpc0xhYmVsOiAnWSBBeGlzJyxcbiAgICAgICAgYXhpc0xhYmVsRGlzdGFuY2U6IDBcbiAgICAgIH0sXG4gICAgfVxuICB9O1xufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5kaXJlY3RpdmUoJ2NoYXJ0c1ZpZXcnLCBbZnVuY3Rpb24oKXtcbiAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBkYXRhOiAnPSdcbiAgICB9LCAvLyB7fSA9IGlzb2xhdGUsIHRydWUgPSBjaGlsZCwgZmFsc2UvdW5kZWZpbmVkID0gbm8gY2hhbmdlXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzLm1haW5DdHJsJyxcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnY2hhcnRzL21haW4vY2hhcnRzLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5jaGFydERhdGEgPSBbe2tleTogXCJDdW11bGF0aXZlIFJldHVyblwiLCB2YWx1ZXM6IFtdfV1cbiAgICAgIHNjb3BlLiR3YXRjaCgnZGF0YScsIGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7XG4gICAgICAgIGlmKHZhbCAhPT0gb2xkVmFsKSB7XG4gICAgICAgICAgc2NvcGUuY2hhcnREYXRhWzBdLnZhbHVlcyA9IF8ubWFwKHZhbC52b3RlcyxmdW5jdGlvbih2KXtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHZhbHVlOiB2LnBlcmNlbnRhZ2UsXG4gICAgICAgICAgICAgIGxhYmVsOiB2LnBvbGl0aWNhbF9wYXJ0eVxuICAgICAgICAgIH19KVxuICAgICAgICAgIHNjb3BlLmNoYXJ0RGF0YVswXS52YWx1ZXMuc29ydChmdW5jdGlvbihhLCBiKXtcbiAgICAgICAgICAgIHJldHVybiBiLnZhbHVlIC0gYS52YWx1ZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

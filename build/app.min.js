"use strict";angular.module("wyborySam2014",["nvd3","smart-table","ui.router","ui.bootstrap","wyborySam2014.area","wyborySam2014.charts","wyborySam2014.tables","wyborySam2014.utils","wyborySam2014.http","wyborySam2014.landingPage"]).constant("DEV_API_PREFIX","http://localhost:8081/api/").constant("HEROKU_API_PREFIX","wyreczamy-pkw.herokuapp.com/api/"),angular.module("wyborySam2014").config(["$stateProvider",function(a){a.state("stats-app",{url:"/app/{dataUrl}",controller:"wyborySam2014.area.ctrl",templateUrl:"area/area.ctrl.html"}).state("landing",{url:"",controller:"wyborySam2014.landing.ctrl",templateUrl:"landing_page/landing.ctrl.html"})}]),angular.module("wyborySam2014.area",[]),angular.module("wyborySam2014.area").controller("wyborySam2014.area.ctrl",["$scope","$rootScope","$http","$stateParams","httpService","urls",function(a,t,e,r,n,o){var i=function(t){var e=t.filter(function(t){return t.type===a.electionKind.type})[0];return e},l=function(t,e){n.getStatsData(t).success(function(r){a.stats=r,a.siteName=e,o.changeDataUrl(t,a.dataUrl,"stats")})};a.chartData={key:"",values:[]},a.dataUrl=r.dataUrl,n.getAreasTree().success(function(t){a.tree=t;var e=o.decode(r.dataUrl),n=o.getSiteName(e);a.electionKind=o.getElectionKind(t,e),a.navTree=i(t),l(e,n)}),a.$watch("electionKind",function(e,r){e!==r&&void 0!==r&&(a.navTree=i(a.tree),t.$broadcast("area::electionTypeChange"),l(a.electionKind.url,"Warszawa"))});var c=t.$on("area::areaTypeChange",function(a,t,e){l(t,e)});a.$on("$destroy",c),a.menuIsVisible=function(){return a.openMenu===!1||a.openMenu===!0},a.menuIsOff=function(){return a.openMenu===!1},a.dropdownIsOff=function(){return a.electionKindsDropwn===!1},a.dropdownIsVisible=function(){return a.electionKindsDropwn===!1||a.electionKindsDropwn===!0},a.changeElectionKind=function(t){a.dataUrl=t.url,a.electionKind={name:t.name,type:t.type,url:t.url},n.getStatsData(t.url).success(function(t){a.statsData=t}),o.changeDataUrl(t.url,"stats"),a.electionKindsDropwn=!1}}]),angular.module("wyborySam2014.charts",[]),angular.module("wyborySam2014.http",[]),angular.module("wyborySam2014.http").factory("httpService",["$http","DEV_API_PREFIX",function(a,t){var e={};return e.getAreasTree=function(){return a.get(t+"stats/areas-tree/")},e.getStatsData=function(e){return a.get(t+e)},e}]),angular.module("wyborySam2014.landingPage",[]),angular.module("wyborySam2014.landingPage").controller("wyborySam2014.landing.ctrl",["$scope","$state","httpService","urls",function(a,t,e,r){e.getAreasTree().success(function(t){a.tree=t}),a.data=null,a.gotoStats=function(a){a||(a="stats/city_council/circle-1/"),t.go("stats-app",{dataUrl:r.code(a)})}}]),angular.module("wyborySam2014.tables",[]),angular.module("wyborySam2014.utils",[]),angular.module("wyborySam2014.utils").factory("urls",["$location",function(a){var t={};return t.code=function(a){return a.replace(/\//g,".")},t.decode=function(a){return a.replace(/\./g,"/")},t.getSiteName=function(a,t){if(a)var e=a.split(t||"/"),r=e[e.length-2].split("-");return a&&"circle"===r[0]?"Okręg nr "+r[1]:a&&"circuit"===r[0]?"Obwód nr "+r[1]:a&&"district"===r[0]?r[1]:"Warszawa"},t.getElectionKind=function(a,t,e){if(!t||!a)return{name:"Wybory do Rady Miasta",type:"city_council",url:"stats/city_council/"};var r=t.split(e||"/")[1],n=a.filter(function(a){return a.type===r})[0];return{name:n.name,type:n.type,url:n.url}},t.changeDataUrl=function(e,r,n){var o=a.path().split("/");o.pop(),o.push(t.code(e)),a.path(o.join("/"))},t}]),angular.module("wyborySam2014.area").directive("mainCity",["$rootScope",function(a){return{scope:{election:"="},restrict:"E",templateUrl:"area/tree/main-city.dir.html",link:function(t,e,r,n){t.deactivateAllBranches=function(t,e){t.stopPropagation(),a.$broadcast("tree.city::deactivateAllBranches")},t.changeArea=function(t,e){t.stopPropagation(),a.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.area").directive("areasTree",["$rootScope",function(a){return{scope:{tree:"="},restrict:"E",templateUrl:"area/tree/tree.dir.html",link:function(t,e,r,n){t.active=-1,t.activateDeactivate=function(a,e){return a.stopPropagation(),-1===t.active?void(t.active=e):void(t.active=-1)};var o=a.$on("area::electionTypeChange",function(){t.active=-1});t.$on("$destroy",o);var i=a.$on("tree.city::deactivateAllBranches",function(){t.active=-1});t.$on("$destroy",i),t.changeArea=function(t,e){t.stopPropagation(),a.$broadcast("area::areaTypeChange",e.url,e.name)}}}}]),angular.module("wyborySam2014.charts").controller("wyborySam2014.charts.mainCtrl",["$scope",function(a){a.options={chart:{type:"discreteBarChart",height:400,margin:{top:20,right:40,bottom:50,left:55},x:function(a){return a.label},y:function(a){return a.value},showValues:!1,valueFormat:function(a){return d3.format(",.2f%")(a)},duration:500,xAxis:{},yAxis:{axisLabelDistance:0}}}}]),angular.module("wyborySam2014.charts").directive("chartsView",[function(){return{scope:{data:"="},controller:"wyborySam2014.charts.mainCtrl",restrict:"E",templateUrl:"charts/main/charts.dir.html",link:function(a,t,e,r){a.chartData=[{key:"Cumulative Return",values:[]}],a.$watch("data",function(t,e){t!==e&&(a.chartData[0].values=_.map(t.votes,function(a){return{value:a.percentage,label:a.political_party}}),a.chartData[0].values.sort(function(a,t){return t.value-a.value}))})}}}]),angular.module("wyborySam2014.tables").controller("wyborySam2014.tables.mainCtrl",["$scope",function(a){a.rowCollection=[{firstName:"Laurent",lastName:"Renard",birthDate:new Date("1987-05-21"),balance:102,email:"whatever@gmail.com"},{firstName:"Blandine",lastName:"Faivre",birthDate:new Date("1987-04-25"),balance:-2323.22,email:"oufblandou@gmail.com"},{firstName:"Francoise",lastName:"Frere",birthDate:new Date("1955-08-27"),balance:42343,email:"raymondef@gmail.com"}]}]),angular.module("wyborySam2014.tables").directive("tablesView",[function(){return{scope:{stats:"=",electionKind:"="},controller:"wyborySam2014.tables.mainCtrl",restrict:"E",templateUrl:"tables/main/tables.dir.html",link:function(a,t,e,r){}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvYXBwLmpzIiwiL3NvdXJjZS9jb25maWcuanMiLCIvc291cmNlL2FyZWEvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2FyZWEvYXJlYS5jdHJsLmpzIiwiL3NvdXJjZS9jaGFydHMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2h0dHBfc2VydmljZXMvaHR0cC5mYWN0LmpzIiwiL3NvdXJjZS9sYW5kaW5nX3BhZ2UvX2RlZmluaXRpb24uanMiLCIvc291cmNlL2xhbmRpbmdfcGFnZS9sYW5kaW5nLmN0cmwuanMiLCIvc291cmNlL3RhYmxlcy9fZGVmaW5pdGlvbi5qcyIsIi9zb3VyY2UvdXRpbHMvX2RlZmluaXRpb24uanMiLCIvc291cmNlL3V0aWxzL2RhdGEtdXJscy5mYWN0LmpzIiwiL3NvdXJjZS9hcmVhL3RyZWUvbWFpbi1jaXR5LmRpci5qcyIsIi9zb3VyY2UvYXJlYS90cmVlL3RyZWUuZGlyLmpzIiwiL3NvdXJjZS9jaGFydHMvbWFpbi9jaGFydHMuY3RybC5qcyIsIi9zb3VyY2UvY2hhcnRzL21haW4vY2hhcnRzLmRpci5qcyIsIi9zb3VyY2UvdGFibGVzL21haW4vdGFibGVzLmN0cmwuanMiLCIvc291cmNlL3RhYmxlcy9tYWluL3RhYmxlcy5kaXIuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNvbnRyb2xsZXIiLCJ0ZW1wbGF0ZVVybCIsIiRzY29wZSIsIiRyb290U2NvcGUiLCIkaHR0cCIsIiRzdGF0ZVBhcmFtcyIsImh0dHBTZXJ2aWNlIiwidXJscyIsImdldE5hdlRyZWUiLCJ0cmVlIiwib25lVHJlZSIsImZpbHRlciIsIm9iaiIsInR5cGUiLCJlbGVjdGlvbktpbmQiLCJnZXREYXRhIiwibmFtZSIsImdldFN0YXRzRGF0YSIsInN1Y2Nlc3MiLCJzdGF0cyIsInNpdGVOYW1lIiwiY2hhbmdlRGF0YVVybCIsImRhdGFVcmwiLCJjaGFydERhdGEiLCJrZXkiLCJ2YWx1ZXMiLCJnZXRBcmVhc1RyZWUiLCJkZWNvZGUiLCJnZXRTaXRlTmFtZSIsImdldEVsZWN0aW9uS2luZCIsIm5hdlRyZWUiLCIkd2F0Y2giLCJ2YWwiLCJvbGRWYWwiLCJ1bmRlZmluZWQiLCIkYnJvYWRjYXN0IiwiZGVzIiwiJG9uIiwiZSIsIm1lbnVJc1Zpc2libGUiLCJvcGVuTWVudSIsIm1lbnVJc09mZiIsImRyb3Bkb3duSXNPZmYiLCJlbGVjdGlvbktpbmRzRHJvcHduIiwiZHJvcGRvd25Jc1Zpc2libGUiLCJjaGFuZ2VFbGVjdGlvbktpbmQiLCJraW5kIiwiZGF0YSIsInN0YXRzRGF0YSIsImZhY3RvcnkiLCJERVZfQVBJX1BSRUZJWCIsInNlbGYiLCJnZXQiLCIkc3RhdGUiLCJnb3RvU3RhdHMiLCJnbyIsImNvZGUiLCIkbG9jYXRpb24iLCJyZXBsYWNlIiwic3BsaXRVcmxQYXJhbSIsInVybHNBcnIiLCJzcGxpdCIsImRhdGFUeXBlIiwibGVuZ3RoIiwibm9kZSIsIlN0YXRlUGFyYW1EYXRhVXJsIiwic2l0ZVR5cGUiLCJwYXRoIiwicG9wIiwicHVzaCIsImpvaW4iLCJkaXJlY3RpdmUiLCJzY29wZSIsImVsZWN0aW9uIiwicmVzdHJpY3QiLCJsaW5rIiwiaUVsbSIsImlBdHRycyIsImRlYWN0aXZhdGVBbGxCcmFuY2hlcyIsImV2ZW50IiwiZWxlbWVudCIsInN0b3BQcm9wYWdhdGlvbiIsImNoYW5nZUFyZWEiLCJhY3RpdmUiLCJhY3RpdmF0ZURlYWN0aXZhdGUiLCJpbmRleCIsImRlczEiLCJvcHRpb25zIiwiY2hhcnQiLCJoZWlnaHQiLCJtYXJnaW4iLCJ0b3AiLCJyaWdodCIsImJvdHRvbSIsImxlZnQiLCJ4IiwiZCIsImxhYmVsIiwieSIsInZhbHVlIiwic2hvd1ZhbHVlcyIsInZhbHVlRm9ybWF0IiwiZDMiLCJmb3JtYXQiLCJkdXJhdGlvbiIsInhBeGlzIiwieUF4aXMiLCJheGlzTGFiZWxEaXN0YW5jZSIsIl8iLCJtYXAiLCJ2b3RlcyIsInYiLCJwZXJjZW50YWdlIiwicG9saXRpY2FsX3BhcnR5Iiwic29ydCIsImEiLCJiIiwicm93Q29sbGVjdGlvbiIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwiYmlydGhEYXRlIiwiRGF0ZSIsImJhbGFuY2UiLCJlbWFpbCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQUEsU0FBQUMsT0FBQSxpQkFDQSxPQUNBLGNBQ0EsWUFDQSxlQUNBLHFCQUNBLHVCQUNBLHVCQUNBLHNCQUNBLHFCQUNBLDhCQUVBQyxTQUFBLGlCQUFBLDhCQUNBQSxTQUFBLG9CQUFBLG9DQ2RBRixRQUFBQyxPQUFBLGlCQUNBRSxRQUFBLGlCQUFBLFNBQUFDLEdBQ0FBLEVBQ0FDLE1BQUEsYUFDQUMsSUFBQSxpQkFDQUMsV0FBQSwwQkFDQUMsWUFBQSx3QkFFQUgsTUFBQSxXQUNBQyxJQUFBLEdBQ0FDLFdBQUEsNkJBQ0FDLFlBQUEsc0NDVkFSLFFBQUFDLE9BQUEseUJDREFELFFBQUFDLE9BQUEsc0JBQ0FNLFdBQUEsMkJBQUEsU0FBQSxhQUFBLFFBQUEsZUFBQSxjQUFBLE9BQ0EsU0FBQUUsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxHQUFBQyxHQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQUQsRUFBQUUsT0FBQSxTQUFBQyxHQUNBLE1BQUFBLEdBQUFDLE9BQUFYLEVBQUFZLGFBQUFELE9BQ0EsRUFDQSxPQUFBSCxJQUdBSyxFQUFBLFNBQUFoQixFQUFBaUIsR0FDQVYsRUFBQVcsYUFBQWxCLEdBQUFtQixRQUFBLFNBQUFDLEdBQ0FqQixFQUFBaUIsTUFBQUEsRUFDQWpCLEVBQUFrQixTQUFBSixFQUNBVCxFQUFBYyxjQUFBdEIsRUFBQUcsRUFBQW9CLFFBQUEsV0FJQXBCLEdBQUFxQixXQUFBQyxJQUFBLEdBQUFDLFdBQ0F2QixFQUFBb0IsUUFBQWpCLEVBQUFpQixRQUVBaEIsRUFBQW9CLGVBQUFSLFFBQUEsU0FBQVQsR0FDQVAsRUFB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QyxXQUNBZixNQUFBYyxFQUFBRSxtQkFFQXpDLEVBQUFqRCxVQUFBLEdBQUFFLE9BQUF5RixLQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUEsR0FBQWpCLE1BQUFnQixFQUFBaEIsZ0JDcEJBMUcsUUFBQUMsT0FBQSx3QkFDQU0sV0FBQSxpQ0FBQSxTQUFBLFNBQUFFLEdBQ0FBLEVBQUFtSCxnQkFDQUMsVUFBQSxVQUFBQyxTQUFBLFNBQUFDLFVBQUEsR0FBQUMsTUFBQSxjQUFBQyxRQUFBLElBQUFDLE1BQUEsdUJBQ0FMLFVBQUEsV0FBQUMsU0FBQSxTQUFBQyxVQUFBLEdBQUFDLE1BQUEsY0FBQUMsUUFBQSxTQUFBQyxNQUFBLHlCQUNBTCxVQUFBLFlBQUFDLFNBQUEsUUFBQUMsVUFBQSxHQUFBQyxNQUFBLGNBQUFDLFFBQUEsTUFBQUMsTUFBQSwyQkNMQWxJLFFBQUFDLE9BQUEsd0JBQ0E2RSxVQUFBLGNBQUEsV0FDQSxPQUNBQyxPQUNBckQsTUFBQSxJQUNBTCxhQUFBLEtBRUFkLFdBQUEsZ0NBQ0EwRSxTQUFBLElBQ0F6RSxZQUFBLDhCQUNBMEUsS0FBQSxTQUFBSCxFQUFBSSxFQUFBQyxFQUFBN0UiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0JywgW1xuICAnbnZkMycsXG4gICdzbWFydC10YWJsZScsXG4gICd1aS5yb3V0ZXInLFxuICAndWkuYm9vdHN0cmFwJyxcbiAgJ3d5Ym9yeVNhbTIwMTQuYXJlYScsXG4gICd3eWJvcnlTYW0yMDE0LmNoYXJ0cycsXG4gICd3eWJvcnlTYW0yMDE0LnRhYmxlcycsXG4gICd3eWJvcnlTYW0yMDE0LnV0aWxzJyxcbiAgJ3d5Ym9yeVNhbTIwMTQuaHR0cCcsXG4gICd3eWJvcnlTYW0yMDE0LmxhbmRpbmdQYWdlJ1xuICBdKVxuLmNvbnN0YW50KCdERVZfQVBJX1BSRUZJWCcsICdodHRwOi8vbG9jYWxob3N0OjgwODEvYXBpLycpXG4uY29uc3RhbnQoJ0hFUk9LVV9BUElfUFJFRklYJywgJ3d5cmVjemFteS1wa3cuaGVyb2t1YXBwLmNvbS9hcGkvJyk7IiwiYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQnKVxuLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpIHtcbiAgJHN0YXRlUHJvdmlkZXJcbiAgLnN0YXRlKCdzdGF0cy1hcHAnLCB7XG4gICAgdXJsOiAnL2FwcC97ZGF0YVVybH0nLFxuICAgIGNvbnRyb2xsZXI6ICd3eWJvcnlTYW0yMDE0LmFyZWEuY3RybCcsXG4gICAgdGVtcGxhdGVVcmw6ICdhcmVhL2FyZWEuY3RybC5odG1sJ1xuICB9KVxuICAuc3RhdGUoJ2xhbmRpbmcnLCB7XG4gICAgdXJsOiAnJyxcbiAgICBjb250cm9sbGVyOiAnd3lib3J5U2FtMjAxNC5sYW5kaW5nLmN0cmwnLFxuICAgIHRlbXBsYXRlVXJsOiAnbGFuZGluZ19wYWdlL2xhbmRpbmcuY3RybC5odG1sJ1xuICB9KVxufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuYXJlYScsIFtdKSIsImFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LmFyZWEnKVxuLmNvbnRyb2xsZXIoJ3d5Ym9yeVNhbTIwMTQuYXJlYS5jdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckaHR0cCcsICckc3RhdGVQYXJhbXMnLCAnaHR0cFNlcnZpY2UnLCAndXJscycsXG4gIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJGh0dHAsICRzdGF0ZVBhcmFtcywgaHR0cFNlcnZpY2UsIHVybHMpe1xuICB2YXIgZ2V0TmF2VHJlZSA9IGZ1bmN0aW9uKHRyZWUpIHtcbiAgICB2YXIgb25lVHJlZSA9IHRyZWUuZmlsdGVyKGZ1bmN0aW9uKG9iail7XG4gICAgICByZXR1cm4gb2JqLnR5cGUgPT09ICRzY29wZS5lbGVjdGlvbktpbmQudHlwZTtcbiAgICB9KVswXTtcbiAgICByZXR1cm4gb25lVHJlZTtcbiAgfTtcblxuICB2YXIgZ2V0RGF0YSA9IGZ1bmN0aW9uICh1cmwsIG5hbWUpIHtcbiAgICBodHRwU2VydmljZS5nZXRTdGF0c0RhdGEodXJsKS5zdWNjZXNzKGZ1bmN0aW9uKHN0YXRzKXtcbiAgICAgICRzY29wZS5zdGF0cyA9IHN0YXRzO1xuICAgICAgJHNjb3BlLnNpdGVOYW1lID0gbmFtZTtcbiAgICAgIHVybHMuY2hhbmdlRGF0YVVybCh1cmwsICRzY29wZS5kYXRhVXJsLCAnc3RhdHMnKTtcbiAgICB9KVxuICB9O1xuXG4gICRzY29wZS5jaGFydERhdGEgPSB7a2V5OiAnJywgdmFsdWVzOiBbXX07XG4gICRzY29wZS5kYXRhVXJsID0gJHN0YXRlUGFyYW1zLmRhdGFVcmw7XG5cbiAgaHR0cFNlcnZpY2UuZ2V0QXJlYXNUcmVlKCkuc3VjY2VzcyhmdW5jdGlvbih0cmVlKSB7XG4gICAgJHNjb3BlLnRyZWUgPSB0cmVlO1xuICAgIFxuICAgIHZhciB1cmwgPSB1cmxzLmRlY29kZSgkc3RhdGVQYXJhbXMuZGF0YVVybCk7XG4gICAgdmFyIG5hbWUgPSB1cmxzLmdldFNpdGVOYW1lKHVybCk7XG4gICAgLy8gY29uc29sZS5sb2coKTtcbiAgICAkc2NvcGUuZWxlY3Rpb25LaW5kID0gdXJscy5nZXRFbGVjdGlvbktpbmQodHJlZSwgdXJsKTtcbiAgICAkc2NvcGUubmF2VHJlZSA9IGdldE5hdlRyZWUodHJlZSk7XG4gICAgZ2V0RGF0YSh1cmwsIG5hbWUpO1xuICB9KTtcblxuICAkc2NvcGUuJHdhdGNoKCdlbGVjdGlvbktpbmQnLCBmdW5jdGlvbih2YWwsIG9sZFZhbCkge1xuICAgIGlmKHZhbCAhPT0gb2xkVmFsICYmIG9sZFZhbCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAkc2NvcGUubmF2VHJlZSA9IGdldE5hdlRyZWUoJHNjb3BlLnRyZWUpO1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhcmVhOjplbGVjdGlvblR5cGVDaGFuZ2UnKTtcbiAgICAgIGdldERhdGEoJHNjb3BlLmVsZWN0aW9uS2luZC51cmwsICdXYXJzemF3YScpO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIGRlcyA9ICRyb290U2NvcGUuJG9uKCdhcmVhOjphcmVhVHlwZUNoYW5nZScsIGZ1bmN0aW9uKGUsIHVybCwgbmFtZSl7XG4gICAgZ2V0RGF0YSh1cmwsIG5hbWUpXG4gIH0pO1xuICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcyk7XG5cbiAgJHNjb3BlLm1lbnVJc1Zpc2libGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLm9wZW5NZW51ID09PSBmYWxzZSB8fCAkc2NvcGUub3Blbk1lbnUgPT09IHRydWU7XG4gIH07XG4gICRzY29wZS5tZW51SXNPZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLm9wZW5NZW51ID09PSBmYWxzZTtcbiAgfTtcbiAgXG4gICRzY29wZS5kcm9wZG93bklzT2ZmID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID09PSBmYWxzZTtcbiAgfTtcblxuICAkc2NvcGUuZHJvcGRvd25Jc1Zpc2libGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJHNjb3BlLmVsZWN0aW9uS2luZHNEcm9wd24gPT09IGZhbHNlIHx8ICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID09PSB0cnVlO1xuICB9O1xuXG4gICRzY29wZS5jaGFuZ2VFbGVjdGlvbktpbmQgPSBmdW5jdGlvbihraW5kKSB7XG4gICAgJHNjb3BlLmRhdGFVcmwgPSBraW5kLnVybDtcbiAgICAkc2NvcGUuZWxlY3Rpb25LaW5kID0ge1xuICAgICAgbmFtZToga2luZC5uYW1lLFxuICAgICAgdHlwZToga2luZC50eXBlLFxuICAgICAgdXJsOiBraW5kLnVybFxuICAgIH07XG4gICAgaHR0cFNlcnZpY2UuZ2V0U3RhdHNEYXRhKGtpbmQudXJsKS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgJHNjb3BlLnN0YXRzRGF0YSA9IGRhdGE7XG4gICAgfSlcbiAgICB1cmxzLmNoYW5nZURhdGFVcmwoa2luZC51cmwsICdzdGF0cycpO1xuICAgICRzY29wZS5lbGVjdGlvbktpbmRzRHJvcHduID0gZmFsc2U7XG4gIH07XG4gIFxuXG4gIFxuICBcbn1dKTsiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5jaGFydHMnLCBbXSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5odHRwJywgW10pIiwiYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuaHR0cCcpXG4uZmFjdG9yeSgnaHR0cFNlcnZpY2UnLCBbJyRodHRwJywgJ0RFVl9BUElfUFJFRklYJywgZnVuY3Rpb24oJGh0dHAsIERFVl9BUElfUFJFRklYKSB7XG4gIHZhciBzZWxmID0ge307XG4gIFxuICBzZWxmLmdldEFyZWFzVHJlZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoREVWX0FQSV9QUkVGSVggKyAnc3RhdHMvYXJlYXMtdHJlZS8nKTtcbiAgfTtcblxuICBzZWxmLmdldFN0YXRzRGF0YSA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHJldHVybiAkaHR0cC5nZXQoREVWX0FQSV9QUkVGSVggKyB1cmwpO1xuICB9O1xuXG4gIHJldHVybiBzZWxmO1xufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQubGFuZGluZ1BhZ2UnLCBbXSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5sYW5kaW5nUGFnZScpXG4uY29udHJvbGxlcignd3lib3J5U2FtMjAxNC5sYW5kaW5nLmN0cmwnLCBbJyRzY29wZScsICckc3RhdGUnLCdodHRwU2VydmljZScsICd1cmxzJyxcbmZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBodHRwU2VydmljZSwgdXJscyl7XG4gIGh0dHBTZXJ2aWNlLmdldEFyZWFzVHJlZSgpLnN1Y2Nlc3MoZnVuY3Rpb24odHJlZSkge1xuICAgICRzY29wZS50cmVlID0gdHJlZTtcbiAgfSk7XG4gICRzY29wZS5kYXRhID0gbnVsbDtcbiAgJHNjb3BlLmdvdG9TdGF0cyA9IGZ1bmN0aW9uKHVybCkge1xuICAgIGlmKCF1cmwpIHtcbiAgICAgIHVybCA9ICdzdGF0cy9jaXR5X2NvdW5jaWwvY2lyY2xlLTEvJztcbiAgICB9XG4gICAgJHN0YXRlLmdvKCdzdGF0cy1hcHAnLCB7ZGF0YVVybDogdXJscy5jb2RlKHVybCl9KTtcbiAgfTtcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnRhYmxlcycsIFtdKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnV0aWxzJywgW10pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQudXRpbHMnKVxuLmZhY3RvcnkoJ3VybHMnLCBbJyRsb2NhdGlvbicsIGZ1bmN0aW9uKCRsb2NhdGlvbil7XG4gIHZhciBzZWxmID0ge307XG4gIFxuICBzZWxmLmNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLy9nLCAnLicpO1xuICB9O1xuICBcbiAgc2VsZi5kZWNvZGUgPSBmdW5jdGlvbih1cmwpIHtcbiAgICByZXR1cm4gdXJsLnJlcGxhY2UoL1xcLi9nLCAnLycpO1xuICB9O1xuXG4gIHNlbGYuZ2V0U2l0ZU5hbWUgPSBmdW5jdGlvbih1cmwsIHNwbGl0VXJsUGFyYW0pIHtcbiAgICBpZih1cmwpIHtcbiAgICAgIHZhciB1cmxzQXJyID0gdXJsLnNwbGl0KHNwbGl0VXJsUGFyYW0gfHwgJy8nKTtcbiAgICAgIHZhciBkYXRhVHlwZSA9IHVybHNBcnJbdXJsc0Fyci5sZW5ndGggLSAyXS5zcGxpdCgnLScpOyAgXG4gICAgfVxuXG4gICAgaWYodXJsICYmIGRhdGFUeXBlWzBdID09PSAnY2lyY2xlJykge1xuICAgICAgcmV0dXJuICdPa3LEmWcgbnIgJyArIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2NpcmN1aXQnKSB7XG4gICAgICByZXR1cm4gJ09id8OzZCBuciAnICsgIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIGlmKHVybCAmJiBkYXRhVHlwZVswXSA9PT0gJ2Rpc3RyaWN0Jykge1xuICAgICAgcmV0dXJuIGRhdGFUeXBlWzFdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiAnV2Fyc3phd2EnO1xuICAgIH1cbiAgfTtcblxuICBzZWxmLmdldEVsZWN0aW9uS2luZCA9IGZ1bmN0aW9uKHRyZWUsIHVybCwgc3BsaXRVcmxQYXJhbSkge1xuICAgIGlmKCF1cmwgfHwgIXRyZWUpIHtcbiAgICAgIHJldHVybiB7IC8vZGVmYXVsdCBkYXRhXG4gICAgICAgIG5hbWU6ICdXeWJvcnkgZG8gUmFkeSBNaWFzdGEnLFxuICAgICAgICB0eXBlOiAnY2l0eV9jb3VuY2lsJyxcbiAgICAgICAgdXJsOiAnc3RhdHMvY2l0eV9jb3VuY2lsLydcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgdHlwZSA9IHVybC5zcGxpdChzcGxpdFVybFBhcmFtIHx8ICcvJylbMV07XG4gICAgdmFyIG5vZGUgPSB0cmVlLmZpbHRlcihmdW5jdGlvbihvYmope1xuICAgICAgcmV0dXJuIG9iai50eXBlID09PSB0eXBlO1xuICAgIH0pWzBdO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBub2RlLm5hbWUsXG4gICAgICB0eXBlOiBub2RlLnR5cGUsXG4gICAgICB1cmw6IG5vZGUudXJsXG4gICAgfTtcbiAgfVxuXG4gIHNlbGYuY2hhbmdlRGF0YVVybCA9IGZ1bmN0aW9uKHVybCwgU3RhdGVQYXJhbURhdGFVcmwsIHNpdGVUeXBlKSB7XG4gICAgXG4gICAgdmFyIGRhdGFVcmwgPSAkbG9jYXRpb24ucGF0aCgpLnNwbGl0KCcvJyk7XG4gICAgXG4gICAgLy9pdCBpcyBkYW5nZXJvdXMgYnV0IG5vdyB3b3JrcyBcbiAgICBkYXRhVXJsLnBvcCgpO1xuICAgIFxuICAgIGRhdGFVcmwucHVzaChzZWxmLmNvZGUodXJsKSk7XG4gICAgJGxvY2F0aW9uLnBhdGgoZGF0YVVybC5qb2luKCcvJykpO1xuICB9XG5cbiAgcmV0dXJuIHNlbGY7XG59XSkiLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnd3lib3J5U2FtMjAxNC5hcmVhJylcbi5kaXJlY3RpdmUoJ21haW5DaXR5JywgWyckcm9vdFNjb3BlJywgZnVuY3Rpb24oJHJvb3RTY29wZSl7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIGVsZWN0aW9uOlwiPVwiXG4gICAgfSwgLy8ge30gPSBpc29sYXRlLCB0cnVlID0gY2hpbGQsIGZhbHNlL3VuZGVmaW5lZCA9IG5vIGNoYW5nZVxuICAgIHJlc3RyaWN0OiAnRScsIC8vIEUgPSBFbGVtZW50LCBBID0gQXR0cmlidXRlLCBDID0gQ2xhc3MsIE0gPSBDb21tZW50XG4gICAgdGVtcGxhdGVVcmw6ICdhcmVhL3RyZWUvbWFpbi1jaXR5LmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5kZWFjdGl2YXRlQWxsQnJhbmNoZXMgPSBmdW5jdGlvbihldmVudCwgZWxlbWVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCd0cmVlLmNpdHk6OmRlYWN0aXZhdGVBbGxCcmFuY2hlcycpIFxuICAgICAgfVxuXG4gICAgICBzY29wZS5jaGFuZ2VBcmVhID0gZnVuY3Rpb24oZXZlbnQsIGVsZW1lbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnYXJlYTo6YXJlYVR5cGVDaGFuZ2UnLCBlbGVtZW50LnVybCwgZWxlbWVudC5uYW1lKTtcbiAgICAgIH07ICBcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuYXJlYScpXG4uZGlyZWN0aXZlKCdhcmVhc1RyZWUnLCBbJyRyb290U2NvcGUnLCBmdW5jdGlvbigkcm9vdFNjb3BlKXtcbiAgcmV0dXJuIHtcbiAgICBzY29wZToge1xuICAgICAgdHJlZTpcIj1cIlxuICAgIH0sIC8vIHt9ID0gaXNvbGF0ZSwgdHJ1ZSA9IGNoaWxkLCBmYWxzZS91bmRlZmluZWQgPSBubyBjaGFuZ2VcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnYXJlYS90cmVlL3RyZWUuZGlyLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBpRWxtLCBpQXR0cnMsIGNvbnRyb2xsZXIpIHtcbiAgICAgIHNjb3BlLmFjdGl2ZSA9IC0xO1xuICAgICAgc2NvcGUuYWN0aXZhdGVEZWFjdGl2YXRlID0gZnVuY3Rpb24oZXZlbnQsIGluZGV4KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBpZihzY29wZS5hY3RpdmUgPT09IC0xKSB7XG4gICAgICAgICAgc2NvcGUuYWN0aXZlID0gaW5kZXg7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNjb3BlLmFjdGl2ZSA9IC0xO1xuICAgICAgfTtcblxuICAgICAgdmFyIGRlcyA9ICRyb290U2NvcGUuJG9uKCdhcmVhOjplbGVjdGlvblR5cGVDaGFuZ2UnLCBmdW5jdGlvbigpe1xuICAgICAgICBzY29wZS5hY3RpdmUgPSAtMTtcbiAgICAgIH0pO1xuICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGRlcyk7XG4gICAgICBcbiAgICAgIHZhciBkZXMxID0gJHJvb3RTY29wZS4kb24oJ3RyZWUuY2l0eTo6ZGVhY3RpdmF0ZUFsbEJyYW5jaGVzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgc2NvcGUuYWN0aXZlID0gLTE7XG4gICAgICB9KTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBkZXMxKTtcblxuICAgICAgc2NvcGUuY2hhbmdlQXJlYSA9IGZ1bmN0aW9uKGV2ZW50LCBlbGVtZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2FyZWE6OmFyZWFUeXBlQ2hhbmdlJywgZWxlbWVudC51cmwsIGVsZW1lbnQubmFtZSk7XG4gICAgICB9O1xuXG4gICAgICBcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LmNoYXJ0cy5tYWluQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKSB7XG4gIFxuICAkc2NvcGUub3B0aW9ucyA9IHtcbiAgICBjaGFydDoge1xuICAgICAgdHlwZTogJ2Rpc2NyZXRlQmFyQ2hhcnQnLFxuICAgICAgaGVpZ2h0OiA0MDAsXG4gICAgICBtYXJnaW4gOiB7XG4gICAgICAgIHRvcDogMjAsXG4gICAgICAgIHJpZ2h0OiA0MCxcbiAgICAgICAgYm90dG9tOiA1MCxcbiAgICAgICAgbGVmdDogNTVcbiAgICAgIH0sXG4gICAgICB4OiBmdW5jdGlvbihkKXtyZXR1cm4gZC5sYWJlbDt9LFxuICAgICAgeTogZnVuY3Rpb24oZCl7cmV0dXJuIGQudmFsdWU7fSxcbiAgICAgIHNob3dWYWx1ZXM6IGZhbHNlLFxuICAgICAgdmFsdWVGb3JtYXQ6IGZ1bmN0aW9uKGQpe1xuICAgICAgICByZXR1cm4gZDMuZm9ybWF0KCcsLjJmJScpKGQpO1xuICAgICAgfSxcbiAgICAgIGR1cmF0aW9uOiA1MDAsXG4gICAgICB4QXhpczoge1xuICAgICAgICAvLyBheGlzTGFiZWw6ICdYIEF4aXMnXG4gICAgICB9LFxuICAgICAgeUF4aXM6IHtcbiAgICAgICAgLy8gYXhpc0xhYmVsOiAnWSBBeGlzJyxcbiAgICAgICAgYXhpc0xhYmVsRGlzdGFuY2U6IDBcbiAgICAgIH0sXG4gICAgfVxuICB9O1xufV0pIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzJylcbi5kaXJlY3RpdmUoJ2NoYXJ0c1ZpZXcnLCBbZnVuY3Rpb24oKXtcbiAgLy8gUnVucyBkdXJpbmcgY29tcGlsZVxuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7XG4gICAgICBkYXRhOiAnPSdcbiAgICB9LCAvLyB7fSA9IGlzb2xhdGUsIHRydWUgPSBjaGlsZCwgZmFsc2UvdW5kZWZpbmVkID0gbm8gY2hhbmdlXG4gICAgY29udHJvbGxlcjogJ3d5Ym9yeVNhbTIwMTQuY2hhcnRzLm1haW5DdHJsJyxcbiAgICByZXN0cmljdDogJ0UnLCAvLyBFID0gRWxlbWVudCwgQSA9IEF0dHJpYnV0ZSwgQyA9IENsYXNzLCBNID0gQ29tbWVudFxuICAgIHRlbXBsYXRlVXJsOiAnY2hhcnRzL21haW4vY2hhcnRzLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICBzY29wZS5jaGFydERhdGEgPSBbe2tleTogXCJDdW11bGF0aXZlIFJldHVyblwiLCB2YWx1ZXM6IFtdfV1cbiAgICAgIHNjb3BlLiR3YXRjaCgnZGF0YScsIGZ1bmN0aW9uKHZhbCwgb2xkVmFsKSB7XG4gICAgICAgIGlmKHZhbCAhPT0gb2xkVmFsKSB7XG4gICAgICAgICAgc2NvcGUuY2hhcnREYXRhWzBdLnZhbHVlcyA9IF8ubWFwKHZhbC52b3RlcyxmdW5jdGlvbih2KXtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHZhbHVlOiB2LnBlcmNlbnRhZ2UsXG4gICAgICAgICAgICAgIGxhYmVsOiB2LnBvbGl0aWNhbF9wYXJ0eVxuICAgICAgICAgIH19KVxuICAgICAgICAgIHNjb3BlLmNoYXJ0RGF0YVswXS52YWx1ZXMuc29ydChmdW5jdGlvbihhLCBiKXtcbiAgICAgICAgICAgIHJldHVybiBiLnZhbHVlIC0gYS52YWx1ZTtcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XSk7IiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ3d5Ym9yeVNhbTIwMTQudGFibGVzJylcbi5jb250cm9sbGVyKCd3eWJvcnlTYW0yMDE0LnRhYmxlcy5tYWluQ3RybCcsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgJHNjb3BlLnJvd0NvbGxlY3Rpb24gPSBbXG4gICAge2ZpcnN0TmFtZTogJ0xhdXJlbnQnLCBsYXN0TmFtZTogJ1JlbmFyZCcsIGJpcnRoRGF0ZTogbmV3IERhdGUoJzE5ODctMDUtMjEnKSwgYmFsYW5jZTogMTAyLCBlbWFpbDogJ3doYXRldmVyQGdtYWlsLmNvbSd9LFxuICAgIHtmaXJzdE5hbWU6ICdCbGFuZGluZScsIGxhc3ROYW1lOiAnRmFpdnJlJywgYmlydGhEYXRlOiBuZXcgRGF0ZSgnMTk4Ny0wNC0yNScpLCBiYWxhbmNlOiAtMjMyMy4yMiwgZW1haWw6ICdvdWZibGFuZG91QGdtYWlsLmNvbSd9LFxuICAgIHtmaXJzdE5hbWU6ICdGcmFuY29pc2UnLCBsYXN0TmFtZTogJ0ZyZXJlJywgYmlydGhEYXRlOiBuZXcgRGF0ZSgnMTk1NS0wOC0yNycpLCBiYWxhbmNlOiA0MjM0MywgZW1haWw6ICdyYXltb25kZWZAZ21haWwuY29tJ31cbiAgXTtcbn1dKSIsIid1c2Ugc3RyaWN0JztcbmFuZ3VsYXIubW9kdWxlKCd3eWJvcnlTYW0yMDE0LnRhYmxlcycpXG4uZGlyZWN0aXZlKCd0YWJsZXNWaWV3JywgW2Z1bmN0aW9uKCl7XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIHN0YXRzOiBcIj1cIixcbiAgICAgIGVsZWN0aW9uS2luZDogXCI9XCJcbiAgICAgIH0sIC8vIHt9ID0gaXNvbGF0ZSwgdHJ1ZSA9IGNoaWxkLCBmYWxzZS91bmRlZmluZWQgPSBubyBjaGFuZ2VcbiAgICBjb250cm9sbGVyOiAnd3lib3J5U2FtMjAxNC50YWJsZXMubWFpbkN0cmwnLFxuICAgIHJlc3RyaWN0OiAnRScsIC8vIEUgPSBFbGVtZW50LCBBID0gQXR0cmlidXRlLCBDID0gQ2xhc3MsIE0gPSBDb21tZW50LFxuICAgIHRlbXBsYXRlVXJsOiAndGFibGVzL21haW4vdGFibGVzLmRpci5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgaUVsbSwgaUF0dHJzLCBjb250cm9sbGVyKSB7XG4gICAgICAvLyBzY29wZS5jYW5kaWRhdGVzVGFibGVMaW1pdCA9IDMwO1xuICAgIH1cbiAgfTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
